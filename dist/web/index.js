/**
 * Copyright Metrichor Ltd. (An Oxford Nanopore Technologies Company) 2020
 */

<<<<<<< HEAD
"use strict";function e(e){return e&&"object"===typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("graphql-tag")),r=require("@apollo/client/core"),o=require("cross-fetch"),n=e(o),s=require("google-protobuf/google/protobuf/empty_pb"),i=e(s),a=require("google-protobuf/google/protobuf/struct_pb"),p=require("rxjs"),l=require("rxjs/operators"),u=e(require("google-protobuf")),c=e(require("google-protobuf/google/protobuf/empty_pb.js")),f=e(require("google-protobuf/google/protobuf/struct_pb.js")),m=require("@improbable-eng/grpc-web"),d=e(m);const h="\npage\npages\nhasNext\nhasPrevious\ntotalCount\n",w="\nidWorkflowInstance\nstartDate\nworkflowImage{\n  workflow\n  {\n    rev\n    name\n  }\n}\n";var g="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function y(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===t||null===t)&&r.path)}},r.exports),r.exports}var R=y((function(e,t){!function(r){var o=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,s="object"==typeof g&&g;s.global!==s&&s.window!==s&&s.self!==s||(r=s);var i,a,p=2147483647,l=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,d=String.fromCharCode;function h(e){throw RangeError(f[e])}function w(e,t){for(var r=e.length,o=[];r--;)o[r]=t(e[r]);return o}function y(e,t){var r=e.split("@"),o="";return r.length>1&&(o=r[0]+"@",e=r[1]),o+w((e=e.replace(c,".")).split("."),t).join(".")}function R(e){for(var t,r,o=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?56320==(64512&(r=e.charCodeAt(n++)))?o.push(((1023&t)<<10)+(1023&r)+65536):(o.push(t),n--):o.push(t);return o}function k(e){return w(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,r){var o=0;for(e=r?m(e/700):e>>1,e+=m(e/t);e>455;o+=36)e=m(e/35);return m(o+36*e/(e+38))}function b(e){var t,r,o,n,s,i,a,l,u,c,f,d=[],w=e.length,g=0,y=128,R=72;for((r=e.lastIndexOf("-"))<0&&(r=0),o=0;o<r;++o)e.charCodeAt(o)>=128&&h("not-basic"),d.push(e.charCodeAt(o));for(n=r>0?r+1:0;n<w;){for(s=g,i=1,a=36;n>=w&&h("invalid-input"),((l=(f=e.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||l>m((p-g)/i))&&h("overflow"),g+=l*i,!(l<(u=a<=R?1:a>=R+26?26:a-R));a+=36)i>m(p/(c=36-u))&&h("overflow"),i*=c;R=I(g-s,t=d.length+1,0==s),m(g/t)>p-y&&h("overflow"),y+=m(g/t),g%=t,d.splice(g++,0,y)}return k(d)}function M(e){var t,r,o,n,s,i,a,l,u,c,f,w,g,y,k,b=[];for(w=(e=R(e)).length,t=128,r=0,s=72,i=0;i<w;++i)(f=e[i])<128&&b.push(d(f));for(o=n=b.length,n&&b.push("-");o<w;){for(a=p,i=0;i<w;++i)(f=e[i])>=t&&f<a&&(a=f);for(a-t>m((p-r)/(g=o+1))&&h("overflow"),r+=(a-t)*g,t=a,i=0;i<w;++i)if((f=e[i])<t&&++r>p&&h("overflow"),f==t){for(l=r,u=36;!(l<(c=u<=s?1:u>=s+26?26:u-s));u+=36)k=l-c,y=36-c,b.push(d(S(c+k%y,0))),l=m(k/y);b.push(d(S(l,0))),s=I(r,g,o==n),r=0,++o}++r,++t}return b.join("")}if(i={version:"1.3.2",ucs2:{decode:R,encode:k},decode:b,encode:M,toASCII:function(e){return y(e,(function(e){return u.test(e)?"xn--"+M(e):e}))},toUnicode:function(e){return y(e,(function(e){return l.test(e)?b(e.slice(4).toLowerCase()):e}))}},o&&n)if(e.exports==o)n.exports=i;else for(a in i)i.hasOwnProperty(a)&&(o[a]=i[a]);else r.punycode=i}(g)}));function k(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var S=function(e,t,r,o){t=t||"&",r=r||"=";var n={};if("string"!==typeof e||0===e.length)return n;var s=/\+/g;e=e.split(t);var i=1e3;o&&"number"===typeof o.maxKeys&&(i=o.maxKeys);var a=e.length;i>0&&a>i&&(a=i);for(var p=0;p<a;++p){var l,u,c,f,m=e[p].replace(s,"%20"),d=m.indexOf(r);d>=0?(l=m.substr(0,d),u=m.substr(d+1)):(l=m,u=""),c=decodeURIComponent(l),f=decodeURIComponent(u),k(n,c)?Array.isArray(n[c])?n[c].push(f):n[c]=[n[c],f]:n[c]=f}return n},I=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},b=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"===typeof e?Object.keys(e).map((function(o){var n=encodeURIComponent(I(o))+r;return Array.isArray(e[o])?e[o].map((function(e){return n+encodeURIComponent(I(e))})).join(t):n+encodeURIComponent(I(e[o]))})).join(t):o?encodeURIComponent(I(o))+r+encodeURIComponent(I(e)):""},M=y((function(e,t){t.decode=t.parse=S,t.encode=t.stringify=b})),E=function(e,t){return _(e,!1,!0).resolve(t)};function v(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var B=/^([a-z0-9.+-]+:)/i,q=/:[0-9]*$/,x=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),F=["'"].concat(x),W=["%","/","?",";","#"].concat(F),j=["/","?","#"],O=/^[a-z0-9A-Z_-]{0,63}$/,D=/^([a-z0-9A-Z_-]{0,63})(.*)$/,A={javascript:!0,"javascript:":!0},z={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function _(e,t,r){if(e&&C(e)&&e instanceof v)return e;var o=new v;return o.parse(e,t,r),o}function $(e){return"string"===typeof e}function C(e){return"object"===typeof e&&null!==e}function U(e){return null===e}v.prototype.parse=function(e,t,r){if(!$(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e;o=o.trim();var n=B.exec(o);if(n){var s=(n=n[0]).toLowerCase();this.protocol=s,o=o.substr(n.length)}if(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var i="//"===o.substr(0,2);!i||n&&z[n]||(o=o.substr(2),this.slashes=!0)}if(!z[n]&&(i||n&&!T[n])){for(var a,p,l=-1,u=0;u<j.length;u++){-1!==(c=o.indexOf(j[u]))&&(-1===l||c<l)&&(l=c)}-1!==(p=-1===l?o.lastIndexOf("@"):o.lastIndexOf("@",l))&&(a=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(a)),l=-1;for(u=0;u<W.length;u++){var c;-1!==(c=o.indexOf(W[u]))&&(-1===l||c<l)&&(l=c)}-1===l&&(l=o.length),this.host=o.slice(0,l),o=o.slice(l),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var m=this.hostname.split(/\./),d=(u=0,m.length);u<d;u++){var h=m[u];if(h&&!h.match(O)){for(var w="",g=0,y=h.length;g<y;g++)h.charCodeAt(g)>127?w+="x":w+=h[g];if(!w.match(O)){var k=m.slice(0,u),S=m.slice(u+1),I=h.match(D);I&&(k.push(I[1]),S.unshift(I[2])),S.length&&(o="/"+S.join(".")+o),this.hostname=k.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!f){var b=this.hostname.split("."),E=[];for(u=0;u<b.length;++u){var v=b[u];E.push(v.match(/[^A-Za-z0-9_-]/)?"xn--"+R.encode(v):v)}this.hostname=E.join(".")}var q=this.port?":"+this.port:"",x=this.hostname||"";this.host=x+q,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!A[s])for(u=0,d=F.length;u<d;u++){var _=F[u],C=encodeURIComponent(_);C===_&&(C=escape(_)),o=o.split(_).join(C)}var U=o.indexOf("#");-1!==U&&(this.hash=o.substr(U),o=o.slice(0,U));var P=o.indexOf("?");if(-1!==P?(this.search=o.substr(P),this.query=o.substr(P+1),t&&(this.query=M.parse(this.query)),o=o.slice(0,P)):t&&(this.search="",this.query={}),o&&(this.pathname=o),T[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){q=this.pathname||"",v=this.search||"";this.path=q+v}return this.href=this.format(),this},v.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",o=this.hash||"",n=!1,s="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&C(this.query)&&Object.keys(this.query).length&&(s=M.stringify(this.query));var i=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||T[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),o&&"#"!==o.charAt(0)&&(o="#"+o),i&&"?"!==i.charAt(0)&&(i="?"+i),t+n+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(i=i.replace("#","%23"))+o},v.prototype.resolve=function(e){return this.resolveObject(_(e,!1,!0)).format()},v.prototype.resolveObject=function(e){if($(e)){var t=new v;t.parse(e,!1,!0),e=t}var r=new v;if(Object.keys(this).forEach((function(e){r[e]=this[e]}),this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(r[t]=e[t])})),T[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!T[e.protocol])return Object.keys(e).forEach((function(t){r[t]=e[t]})),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||z[e.protocol])r.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var n=r.pathname||"",s=r.search||"";r.path=n+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var i=r.pathname&&"/"===r.pathname.charAt(0),a=e.host||e.pathname&&"/"===e.pathname.charAt(0),p=a||i||r.host&&e.pathname,l=p,u=r.pathname&&r.pathname.split("/")||[],c=(o=e.pathname&&e.pathname.split("/")||[],r.protocol&&!T[r.protocol]);if(c&&(r.hostname="",r.port=null,r.host&&(""===u[0]?u[0]=r.host:u.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),p=p&&(""===o[0]||""===u[0])),a)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,u=o;else if(o.length)u||(u=[]),u.pop(),u=u.concat(o),r.search=e.search,r.query=e.query;else if(null!=e.search){if(c)r.hostname=r.host=u.shift(),(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift());return r.search=e.search,r.query=e.query,U(r.pathname)&&U(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!u.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var f=u.slice(-1)[0],m=(r.host||e.host)&&("."===f||".."===f)||""===f,d=0,h=u.length;h>=0;h--)"."==(f=u[h])?u.splice(h,1):".."===f?(u.splice(h,1),d++):d&&(u.splice(h,1),d--);if(!p&&!l)for(;d--;d)u.unshift("..");!p||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),m&&"/"!==u.join("/").substr(-1)&&u.push("");var w,g=""===u[0]||u[0]&&"/"===u[0].charAt(0);c&&(r.hostname=r.host=g?"":u.length?u.shift():"",(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift()));return(p=p||r.host&&u.length)&&!g&&u.unshift(""),u.length?r.pathname=u.join("/"):(r.pathname=null,r.path=null),U(r.pathname)&&U(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},v.prototype.parseHost=function(){var e=this.host,t=q.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};function P(e){return null!==e&&"object"===typeof e&&!1===Array.isArray(e)}function N(e){return"string"===typeof e}function L(e){return null===e||"undefined"===typeof e}function G(e,t){if(N(e))return e;if(L(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to String`)}function J(e,t){if(function(e){return"number"===typeof e}(e))return e;if(L(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Number`)}function H(e,t){if(function(e){return"boolean"===typeof e}(e))return e;if(L(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Boolean`)}let V=n;async function K(e,t=!1){const r=await(t?async function(e){try{return await e.json()}catch(t){return null}}(e):e.json());if(P(r)&&N(r.error))throw new Error(r.error);return r}function X(e={}){var t,r;const n=new o.Headers;if(n.set("Accept","application/json"),n.set("Content-Type","application/json"),n.set("X-EPI2ME-Client",null!==(t=e.user_agent)&&void 0!==t?t:"api"),n.set("X-EPI2ME-Version",null!==(r=e.agent_version)&&void 0!==r?r:"3.0.1445"),e.headers)for(const[o,s]of Object.entries(e.headers))n.set(o,s);return n}async function Z(e,t){var r;const n=X(t),s=new URL(e,t.base_url),i={headers:n,method:null!==(r=t.method)&&void 0!==r?r:"get",agent:t.agent,body:t.body};let a=new o.Request(s.toString(),i);t.mutate_request&&(a=await t.mutate_request(a)),t.log&&t.log(a);let p=await V(a);return await async function(e){if(!e.ok){if(504===e.status)throw new Error("Please check your network connection and try again");throw await K(e,!0),new Error("Network error: "+e.statusText)}}(p),t.mutate_response&&(p=await t.mutate_response(p)),p}function Y(e,t){if(P(e)){if("json"===t)return JSON.stringify(e);if("url"===t){const t=new URLSearchParams;for(const r of Object.keys(e))t.set(r,String(e[r]));return t.set("json",JSON.stringify(e)),t.sort(),t}throw new Error("Invalid body encoding method "+t)}return e}const Q={head:(e,t={})=>Z(e,Object.assign(Object.assign({},t),{method:"head"})),get:async(e,t={})=>K(await Z(e,Object.assign(Object.assign({},t),{method:"get"}))),async post(e,t,r={}){var o;const n=Y(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return K(await Z(e,Object.assign(Object.assign({},r),{body:n,method:"post"})))},async put(e,t,r={}){var o;const n=Y(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return K(await Z(e,Object.assign(Object.assign({},r),{body:n,method:"put"})))}},ee=(...e)=>{};class te{constructor(e){this.initClient=()=>function(e){const t=new r.ApolloLink(t=>{const o=e(),{url:n}=t.getContext(),s=r.createHttpLink({uri:E(n,"/graphql"),fetch:o});return r.execute(s,t)}),o=new r.InMemoryCache;return new r.ApolloClient({link:t,cache:o})}(()=>(e,t={})=>{const r=X({headers:new o.Headers(t.headers)});return r.set("Authorization","Bearer "+this.options.jwt),t.headers=r,n(e,t)}),this.createContext=e=>{const{url:t,apikey:r,apisecret:o}=this.options;return Object.assign({apikey:r,apisecret:o,url:t},e)},this.resetCache=()=>{this.client.resetStore()},this.workflows=this.query(t`
=======
"use strict";function e(e){return e&&"object"===typeof e&&"default"in e?e.default:e}var t=require("rxjs"),s=e(require("graphql-tag")),r=require("@apollo/client/core"),o=require("@lifeomic/axios-fetch"),n=e(require("axios")),i=e(require("crypto")),a=require("lodash"),c=require("tunnel"),h=e(require("os")),l=e(require("socket.io-client")),u=!1,p="https://epi2me.nanoporetech.com",d="EPI2ME API",f="eu-west-1",g=5,w=1200,m=1200,y=5,v=3,k=60,b=600,S=20,$=30,I=3,O="data+telemetry",T=[".fastq",".fq",".fastq.gz",".fq.gz"],E=!0,j="/data";const _="\npage\npages\nhasNext\nhasPrevious\ntotalCount\n",x="\nidWorkflowInstance\nstartDate\nworkflowImage{\n  workflow\n  {\n    rev\n    name\n  }\n}\n";var A="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function C(e,t,s){return e(s={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===t||null===t)&&s.path)}},s.exports),s.exports}var P=C((function(e,t){!function(s){var r=t&&!t.nodeType&&t,o=e&&!e.nodeType&&e,n="object"==typeof A&&A;n.global!==n&&n.window!==n&&n.self!==n||(s=n);var i,a,c=2147483647,h=/^xn--/,l=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function g(e){throw RangeError(p[e])}function w(e,t){for(var s=e.length,r=[];s--;)r[s]=t(e[s]);return r}function m(e,t){var s=e.split("@"),r="";return s.length>1&&(r=s[0]+"@",e=s[1]),r+w((e=e.replace(u,".")).split("."),t).join(".")}function y(e){for(var t,s,r=[],o=0,n=e.length;o<n;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<n?56320==(64512&(s=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&s)+65536):(r.push(t),o--):r.push(t);return r}function v(e){return w(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function k(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function b(e,t,s){var r=0;for(e=s?d(e/700):e>>1,e+=d(e/t);e>455;r+=36)e=d(e/35);return d(r+36*e/(e+38))}function S(e){var t,s,r,o,n,i,a,h,l,u,p,f=[],w=e.length,m=0,y=128,k=72;for((s=e.lastIndexOf("-"))<0&&(s=0),r=0;r<s;++r)e.charCodeAt(r)>=128&&g("not-basic"),f.push(e.charCodeAt(r));for(o=s>0?s+1:0;o<w;){for(n=m,i=1,a=36;o>=w&&g("invalid-input"),((h=(p=e.charCodeAt(o++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||h>d((c-m)/i))&&g("overflow"),m+=h*i,!(h<(l=a<=k?1:a>=k+26?26:a-k));a+=36)i>d(c/(u=36-l))&&g("overflow"),i*=u;k=b(m-n,t=f.length+1,0==n),d(m/t)>c-y&&g("overflow"),y+=d(m/t),m%=t,f.splice(m++,0,y)}return v(f)}function $(e){var t,s,r,o,n,i,a,h,l,u,p,w,m,v,S,$=[];for(w=(e=y(e)).length,t=128,s=0,n=72,i=0;i<w;++i)(p=e[i])<128&&$.push(f(p));for(r=o=$.length,o&&$.push("-");r<w;){for(a=c,i=0;i<w;++i)(p=e[i])>=t&&p<a&&(a=p);for(a-t>d((c-s)/(m=r+1))&&g("overflow"),s+=(a-t)*m,t=a,i=0;i<w;++i)if((p=e[i])<t&&++s>c&&g("overflow"),p==t){for(h=s,l=36;!(h<(u=l<=n?1:l>=n+26?26:l-n));l+=36)S=h-u,v=36-u,$.push(f(k(u+S%v,0))),h=d(S/v);$.push(f(k(h,0))),n=b(s,m,r==o),s=0,++r}++s,++t}return $.join("")}if(i={version:"1.3.2",ucs2:{decode:y,encode:v},decode:S,encode:$,toASCII:function(e){return m(e,(function(e){return l.test(e)?"xn--"+$(e):e}))},toUnicode:function(e){return m(e,(function(e){return h.test(e)?S(e.slice(4).toLowerCase()):e}))}},r&&o)if(e.exports==r)o.exports=i;else for(a in i)i.hasOwnProperty(a)&&(r[a]=i[a]);else s.punycode=i}(A)}));function R(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var q=function(e,t,s,r){t=t||"&",s=s||"=";var o={};if("string"!==typeof e||0===e.length)return o;var n=/\+/g;e=e.split(t);var i=1e3;r&&"number"===typeof r.maxKeys&&(i=r.maxKeys);var a=e.length;i>0&&a>i&&(a=i);for(var c=0;c<a;++c){var h,l,u,p,d=e[c].replace(n,"%20"),f=d.indexOf(s);f>=0?(h=d.substr(0,f),l=d.substr(f+1)):(h=d,l=""),u=decodeURIComponent(h),p=decodeURIComponent(l),R(o,u)?Array.isArray(o[u])?o[u].push(p):o[u]=[o[u],p]:o[u]=p}return o},W=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},D=function(e,t,s,r){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"===typeof e?Object.keys(e).map((function(r){var o=encodeURIComponent(W(r))+s;return Array.isArray(e[r])?e[r].map((function(e){return o+encodeURIComponent(W(e))})).join(t):o+encodeURIComponent(W(e[r]))})).join(t):r?encodeURIComponent(W(r))+s+encodeURIComponent(W(e)):""},U=C((function(e,t){t.decode=t.parse=q,t.encode=t.stringify=D})),H=function(e,t){return Y(e,!1,!0).resolve(t)};function z(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var F=/^([a-z0-9.+-]+:)/i,N=/:[0-9]*$/,L=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),M=["'"].concat(L),B=["%","/","?",";","#"].concat(M),G=["/","?","#"],J=/^[a-z0-9A-Z_-]{0,63}$/,X=/^([a-z0-9A-Z_-]{0,63})(.*)$/,K={javascript:!0,"javascript:":!0},Q={javascript:!0,"javascript:":!0},V={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Y(e,t,s){if(e&&ee(e)&&e instanceof z)return e;var r=new z;return r.parse(e,t,s),r}function Z(e){return"string"===typeof e}function ee(e){return"object"===typeof e&&null!==e}function te(e){return null===e}z.prototype.parse=function(e,t,s){if(!Z(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e;r=r.trim();var o=F.exec(r);if(o){var n=(o=o[0]).toLowerCase();this.protocol=n,r=r.substr(o.length)}if(s||o||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var i="//"===r.substr(0,2);!i||o&&Q[o]||(r=r.substr(2),this.slashes=!0)}if(!Q[o]&&(i||o&&!V[o])){for(var a,c,h=-1,l=0;l<G.length;l++){-1!==(u=r.indexOf(G[l]))&&(-1===h||u<h)&&(h=u)}-1!==(c=-1===h?r.lastIndexOf("@"):r.lastIndexOf("@",h))&&(a=r.slice(0,c),r=r.slice(c+1),this.auth=decodeURIComponent(a)),h=-1;for(l=0;l<B.length;l++){var u;-1!==(u=r.indexOf(B[l]))&&(-1===h||u<h)&&(h=u)}-1===h&&(h=r.length),this.host=r.slice(0,h),r=r.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var d=this.hostname.split(/\./),f=(l=0,d.length);l<f;l++){var g=d[l];if(g&&!g.match(J)){for(var w="",m=0,y=g.length;m<y;m++)g.charCodeAt(m)>127?w+="x":w+=g[m];if(!w.match(J)){var v=d.slice(0,l),k=d.slice(l+1),b=g.match(X);b&&(v.push(b[1]),k.unshift(b[2])),k.length&&(r="/"+k.join(".")+r),this.hostname=v.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){var S=this.hostname.split("."),$=[];for(l=0;l<S.length;++l){var I=S[l];$.push(I.match(/[^A-Za-z0-9_-]/)?"xn--"+P.encode(I):I)}this.hostname=$.join(".")}var O=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+O,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!K[n])for(l=0,f=M.length;l<f;l++){var E=M[l],j=encodeURIComponent(E);j===E&&(j=escape(E)),r=r.split(E).join(j)}var _=r.indexOf("#");-1!==_&&(this.hash=r.substr(_),r=r.slice(0,_));var x=r.indexOf("?");if(-1!==x?(this.search=r.substr(x),this.query=r.substr(x+1),t&&(this.query=U.parse(this.query)),r=r.slice(0,x)):t&&(this.search="",this.query={}),r&&(this.pathname=r),V[n]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){O=this.pathname||"",I=this.search||"";this.path=O+I}return this.href=this.format(),this},z.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",s=this.pathname||"",r=this.hash||"",o=!1,n="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&ee(this.query)&&Object.keys(this.query).length&&(n=U.stringify(this.query));var i=this.search||n&&"?"+n||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||V[t])&&!1!==o?(o="//"+(o||""),s&&"/"!==s.charAt(0)&&(s="/"+s)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),i&&"?"!==i.charAt(0)&&(i="?"+i),t+o+(s=s.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(i=i.replace("#","%23"))+r},z.prototype.resolve=function(e){return this.resolveObject(Y(e,!1,!0)).format()},z.prototype.resolveObject=function(e){if(Z(e)){var t=new z;t.parse(e,!1,!0),e=t}var s=new z;if(Object.keys(this).forEach((function(e){s[e]=this[e]}),this),s.hash=e.hash,""===e.href)return s.href=s.format(),s;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(s[t]=e[t])})),V[s.protocol]&&s.hostname&&!s.pathname&&(s.path=s.pathname="/"),s.href=s.format(),s;if(e.protocol&&e.protocol!==s.protocol){if(!V[e.protocol])return Object.keys(e).forEach((function(t){s[t]=e[t]})),s.href=s.format(),s;if(s.protocol=e.protocol,e.host||Q[e.protocol])s.pathname=e.pathname;else{for(var r=(e.pathname||"").split("/");r.length&&!(e.host=r.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),s.pathname=r.join("/")}if(s.search=e.search,s.query=e.query,s.host=e.host||"",s.auth=e.auth,s.hostname=e.hostname||e.host,s.port=e.port,s.pathname||s.search){var o=s.pathname||"",n=s.search||"";s.path=o+n}return s.slashes=s.slashes||e.slashes,s.href=s.format(),s}var i=s.pathname&&"/"===s.pathname.charAt(0),a=e.host||e.pathname&&"/"===e.pathname.charAt(0),c=a||i||s.host&&e.pathname,h=c,l=s.pathname&&s.pathname.split("/")||[],u=(r=e.pathname&&e.pathname.split("/")||[],s.protocol&&!V[s.protocol]);if(u&&(s.hostname="",s.port=null,s.host&&(""===l[0]?l[0]=s.host:l.unshift(s.host)),s.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===r[0]?r[0]=e.host:r.unshift(e.host)),e.host=null),c=c&&(""===r[0]||""===l[0])),a)s.host=e.host||""===e.host?e.host:s.host,s.hostname=e.hostname||""===e.hostname?e.hostname:s.hostname,s.search=e.search,s.query=e.query,l=r;else if(r.length)l||(l=[]),l.pop(),l=l.concat(r),s.search=e.search,s.query=e.query;else if(null!=e.search){if(u)s.hostname=s.host=l.shift(),(w=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=w.shift(),s.host=s.hostname=w.shift());return s.search=e.search,s.query=e.query,te(s.pathname)&&te(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.href=s.format(),s}if(!l.length)return s.pathname=null,s.search?s.path="/"+s.search:s.path=null,s.href=s.format(),s;for(var p=l.slice(-1)[0],d=(s.host||e.host)&&("."===p||".."===p)||""===p,f=0,g=l.length;g>=0;g--)"."==(p=l[g])?l.splice(g,1):".."===p?(l.splice(g,1),f++):f&&(l.splice(g,1),f--);if(!c&&!h)for(;f--;f)l.unshift("..");!c||""===l[0]||l[0]&&"/"===l[0].charAt(0)||l.unshift(""),d&&"/"!==l.join("/").substr(-1)&&l.push("");var w,m=""===l[0]||l[0]&&"/"===l[0].charAt(0);u&&(s.hostname=s.host=m?"":l.length?l.shift():"",(w=!!(s.host&&s.host.indexOf("@")>0)&&s.host.split("@"))&&(s.auth=w.shift(),s.host=s.hostname=w.shift()));return(c=c||s.host&&l.length)&&!m&&l.unshift(""),l.length?s.pathname=l.join("/"):(s.pathname=null,s.path=null),te(s.pathname)&&te(s.search)||(s.path=(s.pathname?s.pathname:"")+(s.search?s.search:"")),s.auth=e.auth||s.auth,s.slashes=s.slashes||e.slashes,s.href=s.format(),s},z.prototype.parseHost=function(){var e=this.host,t=N.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const se=(...e)=>{},re={debug:se,error:se,info:se,warn:se},oe={info(...e){console.info(`[${(new Date).toISOString()}] INFO:`,...e)},debug(...e){console.debug(`[${(new Date).toISOString()}] DEBUG:`,...e)},warn(...e){console.warn(`[${(new Date).toISOString()}] WARN:`,...e)},error(...e){console.error(`[${(new Date).toISOString()}] ERROR:`,...e)}},ne=(()=>{const e=(e,t={})=>{if(e.headers||(e.headers={}),!t.apikey||!t.apisecret)return;e.headers["X-EPI2ME-APIKEY"]=t.apikey,e.headers["X-EPI2ME-SIGNATUREDATE"]=(new Date).toISOString();const s=[Object.keys(e.headers).sort().filter(e=>e.match(/^x-epi2me/i)).map(t=>`${t}:${e.headers[t]}`).join("\n"),e.body].join("\n"),r=i.createHmac("sha1",t.apisecret).update(s).digest("hex");e.headers["X-EPI2ME-SIGNATUREV0"]=r};return{version:"3.0.1220",setHeaders:(t,s={})=>{var r,o;if(t.headers=a.merge({Accept:"application/json","Content-Type":"application/json","X-EPI2ME-CLIENT":s.user_agent||"api","X-EPI2ME-VERSION":s.agent_version||ne.version},t.headers,s.headers),(null===(r=s.signing)||void 0===r||r)&&e(t,s),s.proxy){const e=s.proxy.match(/https?:\/\/((\S+):(\S+)@)?(\S+):(\d+)/);if(!e)throw new Error("Failed to parse Proxy URL");const r=e[2],n=e[3],i={host:e[4],port:+e[5]};r&&n&&(i.proxyAuth=`${r}:${n}`);const a=null!==(o=s.log)&&void 0!==o?o:re;s.proxy.match(/^https/)?(a.debug("using HTTPS over HTTPS proxy",JSON.stringify(i)),t.httpsAgent=c.httpsOverHttps({proxy:i})):(a.debug("using HTTPS over HTTP proxy",JSON.stringify(i)),t.httpsAgent=c.httpsOverHttp({proxy:i})),t.proxy=!1}}}})(),ie=o.buildAxiosFetch(n),ae=new Set(["get","delete","head","options","post","put","patch","link","unlink"]);function ce({apikey:e,apisecret:t}){return(s,r={})=>{let o;if(r.method&&(n=r.method,!ae.has(n.toLowerCase())))throw new Error("Invalid method "+r.method);var n;return o=r,ne.setHeaders(o,{apikey:e,apisecret:t,signing:!0}),ie(s,r)}}const he=new r.ApolloLink(e=>{const{apikey:t,apisecret:s,url:o}=e.getContext(),n=ce({apikey:t,apisecret:s}),i=r.createHttpLink({uri:H(o,"/graphql"),fetch:n,headers:{keys:{apikey:t,apisecret:s}}});return r.execute(i,e)}),le=new r.InMemoryCache,ue=new r.ApolloClient({link:he,cache:le});function pe(e){return"object"===typeof e&&!1===Array.isArray(e)}function de(e){return"function"===typeof e}function fe(e){return Array.isArray(e)}function ge(e){return"undefined"===typeof e}function we(e){return null===e||"undefined"===typeof e}function me(e,t){if(function(e){return"string"===typeof e}(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to String`)}function ye(e,t){if(function(e){return"number"===typeof e}(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Number`)}function ve(e,t){if(function(e){return"number"===typeof e||"string"===typeof e}(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Index`)}function ke(e,t){if(pe(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Indexable`)}function be(e,t){if(function(e){return"boolean"===typeof e}(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Boolean`)}function Se(e,t){if(fe(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Array`)}function $e(e,t){if(pe(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Record`)}function Ie(e,t){if(de(e))return e;if(we(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Function`)}function Oe(e,t,s){if(we(e)&&"undefined"!==typeof s)return s;if(fe(e))return e.map(t);throw new Error(`Unable to cast ${typeof e} to Array`)}function Te(e){if(!we(e))return me(e)}function Ee(e){if(!we(e))return ye(e)}function je(e){if(!we(e))return ve(e)}function _e(e){if(!we(e))return be(e)}function xe(e){if(!we(e))return Ie(e)}n.defaults.validateStatus=e=>e<=504;const Ae=function(){const e={sign:(e,t)=>{var s,r;if(!t)return;if(e.headers||(e.headers={}),!t.apikey)return;if(e.headers["X-EPI2ME-ApiKey"]=t.apikey,!t.apisecret)return;e.headers["X-EPI2ME-SignatureDate"]=(new Date).toISOString(),(null===(s=e.url)||void 0===s?void 0:s.match(/^https:/))&&(e.url=e.url.replace(/:443/,"")),(null===(r=e.url)||void 0===r?void 0:r.match(/^http:/))&&(e.url=e.url.replace(/:80/,""));const o=[e.url,Object.keys(e.headers).sort().filter(e=>e.match(/^x-epi2me/i)).map(t=>`${t}:${e.headers[t]}`).join("\n")].join("\n"),n=i.createHmac("sha1",t.apisecret).update(o).digest("hex");e.headers["X-EPI2ME-SignatureV0"]=n},responseHandler(e){const t=e&&pe(e.data)?e.data:null;if(e&&e.status>=400){let s="Network error "+e.status;throw(null===t||void 0===t?void 0:t.error)&&(s=t.error+""),504===e.status&&(s="Please check your network connection and try again."),new Error(s)}if(!t)throw new Error("unexpected non-json response");if(t.error)throw new Error(t.error+"");return t}};return{version:"3.0.1220",headers(t,s){var r,o;if(t.headers=Object.assign(Object.assign({Accept:"application/json","Content-Type":"application/json","X-EPI2ME-Client":s.user_agent||"api","X-EPI2ME-Version":s.agent_version||Ae.version},t.headers),s.headers),(null===(r=s.signing)||void 0===r||r)&&e.sign(t,s),s.proxy){const e=s.proxy.match(/https?:\/\/((\S+):(\S+)@)?(\S+):(\d+)/);if(!e)throw new Error("Failed to parse Proxy URL");const r=e[2],n=e[3],i={host:e[4],port:parseInt(e[5],10)};r&&n&&(i.proxyAuth=`${r}:${n}`);const a=null!==(o=s.log)&&void 0!==o?o:re;s.proxy.match(/^https/)?(a.debug("using HTTPS over HTTPS proxy",JSON.stringify(i)),t.httpsAgent=c.httpsOverHttps({proxy:i})):(a.debug("using HTTPS over HTTP proxy",JSON.stringify(i)),t.httpsAgent=c.httpsOverHttp({proxy:i})),t.proxy=!1}},async head(e,t){var s;const r={url:this.mangleURL(e,t)};if(this.headers(r,t),!r.url)throw new Error("unreachable: url argument in HEAD was deleted");(null!==(s=t.log)&&void 0!==s?s:re).debug("HEAD",r.url);const o=await n.head(r.url,r);if(o&&o.status>=400){if(504===o.status)throw new Error("Please check your network connection and try again.");throw new Error("Network error "+o.status)}return o},async get(t,s){var r;const o={url:this.mangleURL(t,s)};if(this.headers(o,s),!o.url)throw new Error("unreachable: url argument in GET was deleted");(null!==(r=s.log)&&void 0!==r?r:re).debug("GET",o.url);const i=await n.get(o.url,o);return e.responseHandler(i)},async post(t,s,r){var o;let i=r.url;i=i.replace(/\/+$/,"");const a={url:`${i}/${t.replace(/\/+/g,"/")}`,data:s,headers:{}};r.legacy_form&&this.processLegacyForm(a,s),this.headers(a,r);const{data:c}=a;delete a.data;const h=null!==(o=r.log)&&void 0!==o?o:re;if(!a.url)throw new Error("unreachable: url argument in POST was deleted");h.debug("POST",a.url);const l=await n.post(a.url,c,a);return r.handler?r.handler(l):e.responseHandler(l)},async put(t,s,r,o){var i;let a=o.url;a=a.replace(/\/+$/,"");const c={url:`${a}/${t.replace(/\/+/g,"/")}/${s}`,data:r,headers:{}};o.legacy_form&&this.processLegacyForm(c,r),this.headers(c,o);const{data:h}=c;delete c.data;const l=null!==(i=o.log)&&void 0!==i?i:re;if(!c.url)throw new Error("unreachable: url argument in PUT was deleted");l.debug("PUT",c.url);const u=await n.put(c.url,h,c);return e.responseHandler(u)},mangleURL(e,t){let s=t.url;return t.skip_url_mangle?e:(e="/"+e,s=s.replace(/\/+$/,""),s+(e=e.replace(/\/+/g,"/")))},processLegacyForm(e,t){const s=[],r=Object.assign({json:JSON.stringify(t)},t);Object.keys(r).sort().forEach(e=>{s.push(`${e}=${escape(r[e]+"")}`)}),e.data=s.join("&"),e.headers["Content-Type"]="application/x-www-form-urlencoded"},convertResponseToObject(e){if("object"===typeof e)return e;try{return JSON.parse(e)}catch(t){throw new Error("exception parsing chain JSON "+String(t))}}}}();class Ce{constructor(e){this.client=ue,this.createContext=e=>{const{apikey:t,apisecret:s,url:r}=this.options;return Object.assign({apikey:t,apisecret:s,url:r},e)},this.resetCache=()=>{this.client.resetStore()},this.workflows=this.query(s`
>>>>>>> dev
    query allWorkflows($page: Int, $pageSize: Int, $isActive: Int, $orderBy: String, $region: String) {
      allWorkflows(page: $page, pageSize: $pageSize, isActive: $isActive, orderBy: $orderBy, region: $region) {
        ${h}
        results {
          ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
        }
      }
    }
  `),this.workflowPages=async e=>{let t=e,r=await this.workflows({variables:{page:t}});const o=async e=>(t=e,r=await this.workflows({variables:{page:t}}),r);return{data:r,next:()=>o(t+1),previous:()=>o(t-1),first:()=>o(1),last:()=>o(0)}},this.workflow=this.query(t`
    query workflow($idWorkflow: ID!) {
      workflow(idWorkflow: $idWorkflow) {
        ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
      }
    }
   `),this.workflowInstances=this.query(t`
  query allWorkflowInstances($page: Int, $pageSize: Int, $shared: Boolean, $idUser: ID, $orderBy: String) {
    allWorkflowInstances(page: $page, pageSize: $pageSize, shared: $shared, idUser: $idUser, orderBy: $orderBy) {
      ${h}
      results {
        ${w}
      }
    }
  }
   `),this.workflowInstance=this.query(t`
      query workflowInstance($idWorkflowInstance: ID!) {
        workflowInstance(idWorkflowInstance: $idWorkflowInstance) {
          ${w}
        }
      }
   `),this.startWorkflow=this.mutate(t`
    mutation startWorkflow(
      $idWorkflow: ID!
      $computeAccountId: ID!
      $storageAccountId: ID
      $isConsentedHuman: Boolean = false
      $idDataset: ID
      $storeResults: Boolean = false
      $userDefined: GenericScalar
      $instanceAttributes: [GenericScalar]
      $region: String
    ) {
      startData: startWorkflowInstance(
        idWorkflow: $idWorkflow
        computeAccountId: $computeAccountId
        storageAccountId: $storageAccountId
        isConsentedHuman: $isConsentedHuman
        idDataset: $idDataset
        storeResults: $storeResults
        userDefined: $userDefined
        instanceAttributes: $instanceAttributes
        region: $region
      ) {
        bucket
        idUser
        remoteAddr
        instance {
          idWorkflowInstance
          chain
          keyId
          outputqueue
          mappedTelemetry
          workflowImage {
            inputqueue
            workflow {
              idWorkflow
            }
            region {
              name
            }
          }
        }
      }
    }
  `),this.stopWorkflow=this.mutate(t`
    mutation stopWorkflowInstance($idWorkflowInstance: ID!) {
      stopData: stopWorkflowInstance(idWorkflowInstance: $idWorkflowInstance) {
        success
        message
      }
    }
  `),this.instanceToken=this.mutate(t`
    mutation getInstanceToken($idWorkflowInstance: ID!) {
      token: getInstanceToken(idWorkflowInstance: $idWorkflowInstance) {
        id_workflow_instance: idWorkflowInstance
        accessKeyId
        secretAccessKey
        sessionToken
        expiration
        region
      }
    }
  `),this.user=this.query(t`
    query user {
      me {
        username
        realname
        useraccountSet {
          idUserAccount
        }
      }
    }
  `),this.updateUser=this.mutate(t`
    mutation updateUser($idRegionPreferred: ID!) {
      updateUser(idRegionPreferred: $idRegionPreferred) {
        idRegionPreferred
      }
    }
  `),this.register=this.mutate(t`
    mutation registerToken($code: String!, $description: String) {
      registerToken(code: $code, description: $description) {
        apikey
        apisecret
        description
      }
    }
  `),this.status=this.query(t`
    query status {
      status {
        portalVersion
        remoteAddr
        serverTime
        minimumAgent
        dbVersion
      }
    }
  `),this.regions=this.query(t`
    query regions {
      regions {
        idRegion
        description
        name
      }
    }
  `);let s=e.url;s=s.replace(/:\/\//,"://graphql."),s=s.replace(/\/$/,"");const{apikey:i,apisecret:a,jwt:p,log:l,local:u,signing:c}=e;this.options={url:s,base_url:s,agent_version:e.agent_version,local:u,user_agent:e.user_agent,signing:c,apikey:i,apisecret:a,jwt:p},this.log=l,this.client=this.initClient()}query(e){return r=>{var o,n,s;const i=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},p=null!==(s=null===r||void 0===r?void 0:r.options)&&void 0!==s?s:{},l=this.createContext(i);let u;return u="string"===typeof e?t`
          ${e}
        `:"function"===typeof e?t`
          ${e(h)}
        `:e,this.client.query(Object.assign(Object.assign({query:u,variables:a},p),{context:l}))}}mutate(e){return r=>{var o,n,s;const i=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},p=null!==(s=null===r||void 0===r?void 0:r.options)&&void 0!==s?s:{},l=this.createContext(i);let u;return u="string"===typeof e?t`
          ${e}
        `:e,this.client.mutate(Object.assign(Object.assign({mutation:u,variables:a},p),{context:l}))}}async convertONTJWT(e,t={token_type:"jwt"}){if("jwt"!==t.token_type&&!t.description)throw new Error("Description required for signature requests");return Q.post("convert-ont",t,Object.assign(Object.assign({},this.options),{log:ee,headers:{"X-ONT-JWT":e}}))}async healthCheck(){return{status:H((await Q.get("/status",Object.assign(Object.assign({},this.options),{log:ee}))).status)}}}te.NETWORK_ONLY="network-only",te.CACHE_FIRST="cache-first",te.CACHE_AND_NETWORK="cache-and-network",te.CACHE_ONLY="cache-only",te.NO_CACHE="no-cache";var re=y((function(e,t){var r=u,o=Function("return this")();r.object.extend(proto,c),r.object.extend(proto,f),r.exportSymbol("proto.epi2me.workflow.RunningInstanceStateReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails",null,o),r.exportSymbol("proto.epi2me.workflow.StartReply",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest.InstanceAttribute",null,o),r.exportSymbol("proto.epi2me.workflow.StopReply",null,o),r.exportSymbol("proto.epi2me.workflow.WorkflowInstanceByIdRequest",null,o),proto.epi2me.workflow.StartRequest=function(e){u.Message.initialize(this,e,0,-1,proto.epi2me.workflow.StartRequest.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.StartRequest,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.displayName="proto.epi2me.workflow.StartRequest"),proto.epi2me.workflow.StartRequest.InstanceAttribute=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartRequest.InstanceAttribute,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.displayName="proto.epi2me.workflow.StartRequest.InstanceAttribute"),proto.epi2me.workflow.StartReply=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartReply,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartReply.displayName="proto.epi2me.workflow.StartReply"),proto.epi2me.workflow.RunningInstancesReply=function(e){u.Message.initialize(this,e,0,-1,proto.epi2me.workflow.RunningInstancesReply.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.displayName="proto.epi2me.workflow.RunningInstancesReply"),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.displayName="proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails"),proto.epi2me.workflow.WorkflowInstanceByIdRequest=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.WorkflowInstanceByIdRequest,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.displayName="proto.epi2me.workflow.WorkflowInstanceByIdRequest"),proto.epi2me.workflow.RunningInstanceStateReply=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstanceStateReply,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstanceStateReply.displayName="proto.epi2me.workflow.RunningInstanceStateReply"),proto.epi2me.workflow.StopReply=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StopReply,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StopReply.displayName="proto.epi2me.workflow.StopReply"),proto.epi2me.workflow.StartRequest.repeatedFields_=[5,25],u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.toObject(e,this)},proto.epi2me.workflow.StartRequest.toObject=function(e,t){var r,o={apikey:u.Message.getFieldWithDefault(t,1,""),apisecret:u.Message.getFieldWithDefault(t,2,""),url:u.Message.getFieldWithDefault(t,3,""),inputfoldersList:null==(r=u.Message.getRepeatedField(t,5))?void 0:r,outputfolder:u.Message.getFieldWithDefault(t,6,""),idworkflow:u.Message.getFieldWithDefault(t,10,""),computeaccountid:u.Message.getFieldWithDefault(t,11,""),storageaccountid:u.Message.getFieldWithDefault(t,20,""),isconsentedhuman:u.Message.getBooleanFieldWithDefault(t,21,!1),iddataset:u.Message.getFieldWithDefault(t,22,""),storeresults:u.Message.getBooleanFieldWithDefault(t,23,!1),userdefined:(r=t.getUserdefined())&&f.Struct.toObject(e,r),instanceattributesList:u.Message.toObjectList(t.getInstanceattributesList(),proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject,e),region:u.Message.getFieldWithDefault(t,26,"")};return e&&(o.$jspbMessageInstance=t),o}),proto.epi2me.workflow.StartRequest.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest;return proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setApikey(r);break;case 2:r=t.readString();e.setApisecret(r);break;case 3:r=t.readString();e.setUrl(r);break;case 5:r=t.readString();e.addInputfolders(r);break;case 6:r=t.readString();e.setOutputfolder(r);break;case 10:r=t.readString();e.setIdworkflow(r);break;case 11:r=t.readString();e.setComputeaccountid(r);break;case 20:r=t.readString();e.setStorageaccountid(r);break;case 21:r=t.readBool();e.setIsconsentedhuman(r);break;case 22:r=t.readString();e.setIddataset(r);break;case 23:r=t.readBool();e.setStoreresults(r);break;case 24:r=new f.Struct;t.readMessage(r,f.Struct.deserializeBinaryFromReader),e.setUserdefined(r);break;case 25:r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;t.readMessage(r,proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader),e.addInstanceattributes(r);break;case 26:r=t.readString();e.setRegion(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.StartRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getApikey()).length>0&&t.writeString(1,r),(r=e.getApisecret()).length>0&&t.writeString(2,r),(r=e.getUrl()).length>0&&t.writeString(3,r),(r=e.getInputfoldersList()).length>0&&t.writeRepeatedString(5,r),(r=e.getOutputfolder()).length>0&&t.writeString(6,r),(r=e.getIdworkflow()).length>0&&t.writeString(10,r),(r=e.getComputeaccountid()).length>0&&t.writeString(11,r),(r=e.getStorageaccountid()).length>0&&t.writeString(20,r),(r=e.getIsconsentedhuman())&&t.writeBool(21,r),(r=e.getIddataset()).length>0&&t.writeString(22,r),(r=e.getStoreresults())&&t.writeBool(23,r),null!=(r=e.getUserdefined())&&t.writeMessage(24,r,f.Struct.serializeBinaryToWriter),(r=e.getInstanceattributesList()).length>0&&t.writeRepeatedMessage(25,r,proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter),(r=e.getRegion()).length>0&&t.writeString(26,r)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject(e,this)},proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject=function(e,t){var r={idAttribute:u.Message.getFieldWithDefault(t,1,0),value:u.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;return proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readUint32();e.setIdAttribute(r);break;case 2:r=t.readString();e.setValue(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter=function(e,t){var r=void 0;0!==(r=e.getIdAttribute())&&t.writeUint32(1,r),(r=e.getValue()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getIdAttribute=function(){return u.Message.getFieldWithDefault(this,1,0)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setIdAttribute=function(e){return u.Message.setProto3IntField(this,1,e)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getValue=function(){return u.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setValue=function(e){return u.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getApikey=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.StartRequest.prototype.setApikey=function(e){return u.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.StartRequest.prototype.getApisecret=function(){return u.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.prototype.setApisecret=function(e){return u.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getUrl=function(){return u.Message.getFieldWithDefault(this,3,"")},proto.epi2me.workflow.StartRequest.prototype.setUrl=function(e){return u.Message.setProto3StringField(this,3,e)},proto.epi2me.workflow.StartRequest.prototype.getInputfoldersList=function(){return u.Message.getRepeatedField(this,5)},proto.epi2me.workflow.StartRequest.prototype.setInputfoldersList=function(e){return u.Message.setField(this,5,e||[])},proto.epi2me.workflow.StartRequest.prototype.addInputfolders=function(e,t){return u.Message.addToRepeatedField(this,5,e,t)},proto.epi2me.workflow.StartRequest.prototype.clearInputfoldersList=function(){return this.setInputfoldersList([])},proto.epi2me.workflow.StartRequest.prototype.getOutputfolder=function(){return u.Message.getFieldWithDefault(this,6,"")},proto.epi2me.workflow.StartRequest.prototype.setOutputfolder=function(e){return u.Message.setProto3StringField(this,6,e)},proto.epi2me.workflow.StartRequest.prototype.getIdworkflow=function(){return u.Message.getFieldWithDefault(this,10,"")},proto.epi2me.workflow.StartRequest.prototype.setIdworkflow=function(e){return u.Message.setProto3StringField(this,10,e)},proto.epi2me.workflow.StartRequest.prototype.getComputeaccountid=function(){return u.Message.getFieldWithDefault(this,11,"")},proto.epi2me.workflow.StartRequest.prototype.setComputeaccountid=function(e){return u.Message.setProto3StringField(this,11,e)},proto.epi2me.workflow.StartRequest.prototype.getStorageaccountid=function(){return u.Message.getFieldWithDefault(this,20,"")},proto.epi2me.workflow.StartRequest.prototype.setStorageaccountid=function(e){return u.Message.setProto3StringField(this,20,e)},proto.epi2me.workflow.StartRequest.prototype.getIsconsentedhuman=function(){return u.Message.getBooleanFieldWithDefault(this,21,!1)},proto.epi2me.workflow.StartRequest.prototype.setIsconsentedhuman=function(e){return u.Message.setProto3BooleanField(this,21,e)},proto.epi2me.workflow.StartRequest.prototype.getIddataset=function(){return u.Message.getFieldWithDefault(this,22,"")},proto.epi2me.workflow.StartRequest.prototype.setIddataset=function(e){return u.Message.setProto3StringField(this,22,e)},proto.epi2me.workflow.StartRequest.prototype.getStoreresults=function(){return u.Message.getBooleanFieldWithDefault(this,23,!1)},proto.epi2me.workflow.StartRequest.prototype.setStoreresults=function(e){return u.Message.setProto3BooleanField(this,23,e)},proto.epi2me.workflow.StartRequest.prototype.getUserdefined=function(){return u.Message.getWrapperField(this,f.Struct,24)},proto.epi2me.workflow.StartRequest.prototype.setUserdefined=function(e){return u.Message.setWrapperField(this,24,e)},proto.epi2me.workflow.StartRequest.prototype.clearUserdefined=function(){return this.setUserdefined(void 0)},proto.epi2me.workflow.StartRequest.prototype.hasUserdefined=function(){return null!=u.Message.getField(this,24)},proto.epi2me.workflow.StartRequest.prototype.getInstanceattributesList=function(){return u.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.StartRequest.InstanceAttribute,25)},proto.epi2me.workflow.StartRequest.prototype.setInstanceattributesList=function(e){return u.Message.setRepeatedWrapperField(this,25,e)},proto.epi2me.workflow.StartRequest.prototype.addInstanceattributes=function(e,t){return u.Message.addToRepeatedWrapperField(this,25,e,proto.epi2me.workflow.StartRequest.InstanceAttribute,t)},proto.epi2me.workflow.StartRequest.prototype.clearInstanceattributesList=function(){return this.setInstanceattributesList([])},proto.epi2me.workflow.StartRequest.prototype.getRegion=function(){return u.Message.getFieldWithDefault(this,26,"")},proto.epi2me.workflow.StartRequest.prototype.setRegion=function(e){return u.Message.setProto3StringField(this,26,e)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartReply.prototype.toObject=function(e){return proto.epi2me.workflow.StartReply.toObject(e,this)},proto.epi2me.workflow.StartReply.toObject=function(e,t){var r={started:u.Message.getBooleanFieldWithDefault(t,1,!1),idworkflowinstance:u.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartReply.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.StartReply;return proto.epi2me.workflow.StartReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setStarted(r);break;case 2:r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartReply.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.StartReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getStarted())&&t.writeBool(1,r),(r=e.getIdworkflowinstance()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartReply.prototype.getStarted=function(){return u.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StartReply.prototype.setStarted=function(e){return u.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.StartReply.prototype.getIdworkflowinstance=function(){return u.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartReply.prototype.setIdworkflowinstance=function(e){return u.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.RunningInstancesReply.repeatedFields_=[1],u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.toObject=function(e,t){var r={workflowinstanceList:u.Message.toObjectList(t.getWorkflowinstanceList(),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject,e)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply;return proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;t.readMessage(r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader),e.addWorkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getWorkflowinstanceList()).length>0&&t.writeRepeatedMessage(1,r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject=function(e,t){var r={idworkflowinstance:u.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.getIdworkflowinstance=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.setIdworkflowinstance=function(e){return u.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.getWorkflowinstanceList=function(){return u.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,1)},proto.epi2me.workflow.RunningInstancesReply.prototype.setWorkflowinstanceList=function(e){return u.Message.setRepeatedWrapperField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.addWorkflowinstance=function(e,t){return u.Message.addToRepeatedWrapperField(this,1,e,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,t)},proto.epi2me.workflow.RunningInstancesReply.prototype.clearWorkflowinstanceList=function(){return this.setWorkflowinstanceList([])},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.toObject=function(e){return proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject(e,this)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject=function(e,t){var r={idworkflowinstance:u.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.WorkflowInstanceByIdRequest;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.getIdworkflowinstance=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.setIdworkflowinstance=function(e){return u.Message.setProto3StringField(this,1,e)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstanceStateReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstanceStateReply.toObject(e,this)},proto.epi2me.workflow.RunningInstanceStateReply.toObject=function(e,t){var r={upload:u.Message.getBooleanFieldWithDefault(t,1,!1),analyse:u.Message.getBooleanFieldWithDefault(t,2,!1),report:u.Message.getBooleanFieldWithDefault(t,3,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstanceStateReply;return proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setUpload(r);break;case 2:r=t.readBool();e.setAnalyse(r);break;case 3:r=t.readBool();e.setReport(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstanceStateReply.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getUpload())&&t.writeBool(1,r),(r=e.getAnalyse())&&t.writeBool(2,r),(r=e.getReport())&&t.writeBool(3,r)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getUpload=function(){return u.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setUpload=function(e){return u.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getAnalyse=function(){return u.Message.getBooleanFieldWithDefault(this,2,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setAnalyse=function(e){return u.Message.setProto3BooleanField(this,2,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getReport=function(){return u.Message.getBooleanFieldWithDefault(this,3,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setReport=function(e){return u.Message.setProto3BooleanField(this,3,e)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StopReply.prototype.toObject=function(e){return proto.epi2me.workflow.StopReply.toObject(e,this)},proto.epi2me.workflow.StopReply.toObject=function(e,t){var r={success:u.Message.getBooleanFieldWithDefault(t,1,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StopReply.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.workflow.StopReply;return proto.epi2me.workflow.StopReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StopReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setSuccess(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StopReply.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.workflow.StopReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StopReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getSuccess())&&t.writeBool(1,r)},proto.epi2me.workflow.StopReply.prototype.getSuccess=function(){return u.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StopReply.prototype.setSuccess=function(e){return u.Message.setProto3BooleanField(this,1,e)},r.object.extend(t,proto.epi2me.workflow)})),oe=(d.grpc,function(){function e(){}return e.serviceName="epi2me.workflow.Workflow",e}());oe.start={methodName:"start",service:oe,requestStream:!1,responseStream:!1,requestType:re.StartRequest,responseType:re.StartReply},oe.stopUpload={methodName:"stopUpload",service:oe,requestStream:!1,responseStream:!1,requestType:re.WorkflowInstanceByIdRequest,responseType:re.StopReply},oe.stopAnalysis={methodName:"stopAnalysis",service:oe,requestStream:!1,responseStream:!1,requestType:re.WorkflowInstanceByIdRequest,responseType:re.StopReply},oe.running={methodName:"running",service:oe,requestStream:!1,responseStream:!0,requestType:i.Empty,responseType:re.RunningInstancesReply},oe.instanceRunningState={methodName:"instanceRunningState",service:oe,requestStream:!1,responseStream:!0,requestType:re.WorkflowInstanceByIdRequest,responseType:re.RunningInstanceStateReply};var ne=oe;const se=m.grpc.Code;function ie(e,t,r,o){const{grpcUrl:n,request:s,service:i}=o;t!==se.OK&&t!==se.Aborted&&e.error({code:t,code_text:se[t],host:n,message:r,request:s,service:i.service.serviceName,method:i.methodName})}function ae({tokens:e}){const t=new m.grpc.Metadata;return t.set("jwt",e.jwt),t}function pe(e,t,r,o,n=!1,s){const i={grpcUrl:e,tokens:t,service:r,request:o,transport:s};return p.Observable.create(t=>{if(!e)return t.error({message:"No grpc URL provided"}),p.of(null);const r=n?function(e,t){const{grpcUrl:r,request:o,service:n,tokens:s,transport:i}=t;return m.grpc.invoke(n,{transport:i,host:r,metadata:ae({tokens:s}),onEnd:(r,o)=>{ie(e,r,o,t),e.complete()},onMessage:t=>{t&&e.next(t)},request:o})}(t,i):function(e,t){const{grpcUrl:r,request:o,service:n,tokens:s,transport:i}=t;return m.grpc.unary(n,{transport:i,host:r,metadata:ae({tokens:s}),onEnd:({status:r,message:o})=>{o&&e.next(o),ie(e,r,o,t),e.complete()},request:o})}(t,i);return()=>{r.close(),t.complete()}})}m.grpc.setDefaultTransport(m.grpc.FetchReadableStreamTransport({credentials:"omit"}));class le{constructor(e,t,r){this._url=e,this._jwt=t,this._transport=r,this._destroySubs$=new p.Subject}close(){this._destroySubs$.next()}getRunning$(){const e=new s.Empty;return pe(this._url,{jwt:this._jwt},ne.running,e,!0,this._transport).pipe(l.map(e=>e.toObject()),l.takeUntil(this._destroySubs$))}start$(e,t){const r=new re.StartRequest,{apikey:o,apisecret:n,url:s,inputFolders:i,outputFolder:p}=e;r.setApikey(o),r.setApisecret(n),r.setInputfoldersList(i),s&&r.setUrl(s),p&&r.setOutputfolder(p);const{idWorkflow:u,computeAccountId:c,storageAccountId:f,isConsentedHuman:m,idDataset:d,storeResults:h,region:w,userDefined:g={},instanceAttributes:y=[]}=t;r.setIdworkflow(G(u)),r.setComputeaccountid(G(c)),f&&r.setStorageaccountid(G(f)),m&&r.setIsconsentedhuman(m),d&&r.setIddataset(G(d)),h&&r.setStoreresults(h),w&&r.setRegion(w),r.setUserdefined(a.Struct.fromJavaScript(g));for(const a of y){const e=new re.StartRequest.InstanceAttribute;e.setIdAttribute(J(a.id_attribute)),e.setValue(a.value),r.addInstanceattributes(e)}return pe(this._url,{jwt:this._jwt},ne.running,r,!1,this._transport).pipe(l.map(e=>e.toObject()),l.takeUntil(this._destroySubs$))}stop(e,t){const r=new re.WorkflowInstanceByIdRequest;return r.setIdworkflowinstance(e),pe(this._url,{jwt:this._jwt},t,r,!1,this._transport).pipe(l.map(e=>e.toObject()),l.takeUntil(this._destroySubs$))}stopUpload(e){return this.stop(e,ne.stopUpload)}stopAnalysis(e){return this.stop(e,ne.stopUpload)}state(e){const t=new re.WorkflowInstanceByIdRequest;return t.setIdworkflowinstance(e),pe(this._url,{jwt:this._jwt},ne.instanceRunningState,t,!0,this._transport).pipe(l.map(e=>e.toObject()),l.takeUntil(this._destroySubs$))}}var ue=y((function(e,t){var r=u,o=Function("return this")();r.exportSymbol("proto.epi2me.samples.ExperimentMap",null,o),r.exportSymbol("proto.epi2me.samples.ExperimentMap.Experiment",null,o),r.exportSymbol("proto.epi2me.samples.ExperimentMap.Sample",null,o),r.exportSymbol("proto.epi2me.samples.SamplesRequest",null,o),proto.epi2me.samples.SamplesRequest=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.SamplesRequest,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.SamplesRequest.displayName="proto.epi2me.samples.SamplesRequest"),proto.epi2me.samples.ExperimentMap=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.ExperimentMap,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.displayName="proto.epi2me.samples.ExperimentMap"),proto.epi2me.samples.ExperimentMap.Experiment=function(e){u.Message.initialize(this,e,0,-1,proto.epi2me.samples.ExperimentMap.Experiment.repeatedFields_,null)},r.inherits(proto.epi2me.samples.ExperimentMap.Experiment,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.Experiment.displayName="proto.epi2me.samples.ExperimentMap.Experiment"),proto.epi2me.samples.ExperimentMap.Sample=function(e){u.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.ExperimentMap.Sample,u.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.Sample.displayName="proto.epi2me.samples.ExperimentMap.Sample"),u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.SamplesRequest.prototype.toObject=function(e){return proto.epi2me.samples.SamplesRequest.toObject(e,this)},proto.epi2me.samples.SamplesRequest.toObject=function(e,t){var r={path:u.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.SamplesRequest.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.samples.SamplesRequest;return proto.epi2me.samples.SamplesRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.SamplesRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setPath(r);break;default:t.skipField()}}return e},proto.epi2me.samples.SamplesRequest.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.samples.SamplesRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.SamplesRequest.serializeBinaryToWriter=function(e,t){var r;(r=e.getPath()).length>0&&t.writeString(1,r)},proto.epi2me.samples.SamplesRequest.prototype.getPath=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.SamplesRequest.prototype.setPath=function(e){return u.Message.setProto3StringField(this,1,e)},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.toObject(e,this)},proto.epi2me.samples.ExperimentMap.toObject=function(e,t){var r,o={experimentsMap:(r=t.getExperimentsMap())?r.toObject(e,proto.epi2me.samples.ExperimentMap.Experiment.toObject):[]};return e&&(o.$jspbMessageInstance=t),o}),proto.epi2me.samples.ExperimentMap.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap;return proto.epi2me.samples.ExperimentMap.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=e.getExperimentsMap();t.readMessage(r,(function(e,t){u.Map.deserializeBinary(e,t,u.BinaryReader.prototype.readString,u.BinaryReader.prototype.readMessage,proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader,"",new proto.epi2me.samples.ExperimentMap.Experiment)}));break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.samples.ExperimentMap.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getExperimentsMap(!0))&&r.getLength()>0&&r.serializeBinary(1,t,u.BinaryWriter.prototype.writeString,u.BinaryWriter.prototype.writeMessage,proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter)},proto.epi2me.samples.ExperimentMap.Experiment.repeatedFields_=[2],u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.Experiment.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.Experiment.toObject(e,this)},proto.epi2me.samples.ExperimentMap.Experiment.toObject=function(e,t){var r={startdate:u.Message.getFieldWithDefault(t,1,""),samplesList:u.Message.toObjectList(t.getSamplesList(),proto.epi2me.samples.ExperimentMap.Sample.toObject,e)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap.Experiment;return proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setStartdate(r);break;case 2:r=new proto.epi2me.samples.ExperimentMap.Sample;t.readMessage(r,proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader),e.addSamples(r);break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.Experiment.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getStartdate()).length>0&&t.writeString(1,r),(r=e.getSamplesList()).length>0&&t.writeRepeatedMessage(2,r,proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.getStartdate=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.ExperimentMap.Experiment.prototype.setStartdate=function(e){return u.Message.setProto3StringField(this,1,e)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.getSamplesList=function(){return u.Message.getRepeatedWrapperField(this,proto.epi2me.samples.ExperimentMap.Sample,2)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.setSamplesList=function(e){return u.Message.setRepeatedWrapperField(this,2,e)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.addSamples=function(e,t){return u.Message.addToRepeatedWrapperField(this,2,e,proto.epi2me.samples.ExperimentMap.Sample,t)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.clearSamplesList=function(){return this.setSamplesList([])},u.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.Sample.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.Sample.toObject(e,this)},proto.epi2me.samples.ExperimentMap.Sample.toObject=function(e,t){var r={flowcell:u.Message.getFieldWithDefault(t,1,""),sample:u.Message.getFieldWithDefault(t,2,""),path:u.Message.getFieldWithDefault(t,3,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.ExperimentMap.Sample.deserializeBinary=function(e){var t=new u.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap.Sample;return proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setFlowcell(r);break;case 2:r=t.readString();e.setSample(r);break;case 3:r=t.readString();e.setPath(r);break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.Sample.prototype.serializeBinary=function(){var e=new u.BinaryWriter;return proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getFlowcell()).length>0&&t.writeString(1,r),(r=e.getSample()).length>0&&t.writeString(2,r),(r=e.getPath()).length>0&&t.writeString(3,r)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getFlowcell=function(){return u.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setFlowcell=function(e){return u.Message.setProto3StringField(this,1,e)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getSample=function(){return u.Message.getFieldWithDefault(this,2,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setSample=function(e){return u.Message.setProto3StringField(this,2,e)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getPath=function(){return u.Message.getFieldWithDefault(this,3,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setPath=function(e){return u.Message.setProto3StringField(this,3,e)},proto.epi2me.samples.ExperimentMap.prototype.getExperimentsMap=function(e){return u.Message.getMapField(this,1,e,proto.epi2me.samples.ExperimentMap.Experiment)},proto.epi2me.samples.ExperimentMap.prototype.clearExperimentsMap=function(){return this.getExperimentsMap().clear(),this},r.object.extend(t,proto.epi2me.samples)})),ce=(d.grpc,function(){function e(){}return e.serviceName="epi2me.samples.Samples",e}());ce.Samples={methodName:"Samples",service:ce,requestStream:!1,responseStream:!1,requestType:ue.SamplesRequest,responseType:ue.ExperimentMap};var fe=ce;class me{constructor(e,t,r){this._url=e,this._jwt=t,this._transport=r,this._destroySubs$=new p.Subject}close(){this._destroySubs$.next()}getSamples$(e){const t=new ue.SamplesRequest;return t.setPath(e),pe(this._url,{jwt:this._jwt},fe.Samples,t,!0,this._transport).pipe(l.map(e=>e.toObject()),l.takeUntil(this._destroySubs$))}}exports.EPI2ME_RPC=class{constructor(e,t,r){this.url=e,this.workflowApi=new le(e,t,r),this.samplesApi=new me(e,t,r)}close(){this.samplesApi.close()}},exports.GraphQL=te;
