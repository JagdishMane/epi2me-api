/**
 * Copyright Metrichor Ltd. (An Oxford Nanopore Technologies Company) 2020
 */

import e from"graphql-tag";import{ApolloClient as t,ApolloLink as r,createHttpLink as o,execute as n,InMemoryCache as s}from"@apollo/client/core";import i,{Headers as a,Request as p}from"cross-fetch";import l from"google-protobuf";import u from"google-protobuf/google/protobuf/empty_pb.js";import c from"google-protobuf/google/protobuf/struct_pb.js";import m,{Empty as f}from"google-protobuf/google/protobuf/empty_pb";import d,{grpc as h}from"@improbable-eng/grpc-web";import{Struct as w}from"google-protobuf/google/protobuf/struct_pb";import{Observable as g,of as y,Subject as R}from"rxjs";import{map as k,takeUntil as S}from"rxjs/operators";const I="\npage\npages\nhasNext\nhasPrevious\ntotalCount\n",b="\nidWorkflowInstance\nstartDate\nworkflowImage{\n  workflow\n  {\n    rev\n    name\n  }\n}\n";var M="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function E(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===t||null===t)&&r.path)}},r.exports),r.exports}var v=E((function(e,t){!function(r){var o=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,s="object"==typeof M&&M;s.global!==s&&s.window!==s&&s.self!==s||(r=s);var i,a,p=2147483647,l=/^xn--/,u=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,d=String.fromCharCode;function h(e){throw RangeError(m[e])}function w(e,t){for(var r=e.length,o=[];r--;)o[r]=t(e[r]);return o}function g(e,t){var r=e.split("@"),o="";return r.length>1&&(o=r[0]+"@",e=r[1]),o+w((e=e.replace(c,".")).split("."),t).join(".")}function y(e){for(var t,r,o=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?56320==(64512&(r=e.charCodeAt(n++)))?o.push(((1023&t)<<10)+(1023&r)+65536):(o.push(t),n--):o.push(t);return o}function R(e){return w(e,(function(e){var t="";return e>65535&&(t+=d((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=d(e)})).join("")}function k(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var o=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;o+=36)e=f(e/35);return f(o+36*e/(e+38))}function I(e){var t,r,o,n,s,i,a,l,u,c,m,d=[],w=e.length,g=0,y=128,k=72;for((r=e.lastIndexOf("-"))<0&&(r=0),o=0;o<r;++o)e.charCodeAt(o)>=128&&h("not-basic"),d.push(e.charCodeAt(o));for(n=r>0?r+1:0;n<w;){for(s=g,i=1,a=36;n>=w&&h("invalid-input"),((l=(m=e.charCodeAt(n++))-48<10?m-22:m-65<26?m-65:m-97<26?m-97:36)>=36||l>f((p-g)/i))&&h("overflow"),g+=l*i,!(l<(u=a<=k?1:a>=k+26?26:a-k));a+=36)i>f(p/(c=36-u))&&h("overflow"),i*=c;k=S(g-s,t=d.length+1,0==s),f(g/t)>p-y&&h("overflow"),y+=f(g/t),g%=t,d.splice(g++,0,y)}return R(d)}function b(e){var t,r,o,n,s,i,a,l,u,c,m,w,g,R,I,b=[];for(w=(e=y(e)).length,t=128,r=0,s=72,i=0;i<w;++i)(m=e[i])<128&&b.push(d(m));for(o=n=b.length,n&&b.push("-");o<w;){for(a=p,i=0;i<w;++i)(m=e[i])>=t&&m<a&&(a=m);for(a-t>f((p-r)/(g=o+1))&&h("overflow"),r+=(a-t)*g,t=a,i=0;i<w;++i)if((m=e[i])<t&&++r>p&&h("overflow"),m==t){for(l=r,u=36;!(l<(c=u<=s?1:u>=s+26?26:u-s));u+=36)I=l-c,R=36-c,b.push(d(k(c+I%R,0))),l=f(I/R);b.push(d(k(l,0))),s=S(r,g,o==n),r=0,++o}++r,++t}return b.join("")}if(i={version:"1.3.2",ucs2:{decode:y,encode:R},decode:I,encode:b,toASCII:function(e){return g(e,(function(e){return u.test(e)?"xn--"+b(e):e}))},toUnicode:function(e){return g(e,(function(e){return l.test(e)?I(e.slice(4).toLowerCase()):e}))}},o&&n)if(e.exports==o)n.exports=i;else for(a in i)i.hasOwnProperty(a)&&(o[a]=i[a]);else r.punycode=i}(M)}));function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var x=function(e,t,r,o){t=t||"&",r=r||"=";var n={};if("string"!==typeof e||0===e.length)return n;var s=/\+/g;e=e.split(t);var i=1e3;o&&"number"===typeof o.maxKeys&&(i=o.maxKeys);var a=e.length;i>0&&a>i&&(a=i);for(var p=0;p<a;++p){var l,u,c,m,f=e[p].replace(s,"%20"),d=f.indexOf(r);d>=0?(l=f.substr(0,d),u=f.substr(d+1)):(l=f,u=""),c=decodeURIComponent(l),m=decodeURIComponent(u),B(n,c)?Array.isArray(n[c])?n[c].push(m):n[c]=[n[c],m]:n[c]=m}return n},F=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},q=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"===typeof e?Object.keys(e).map((function(o){var n=encodeURIComponent(F(o))+r;return Array.isArray(e[o])?e[o].map((function(e){return n+encodeURIComponent(F(e))})).join(t):n+encodeURIComponent(F(e[o]))})).join(t):o?encodeURIComponent(F(o))+r+encodeURIComponent(F(e)):""},W=E((function(e,t){t.decode=t.parse=x,t.encode=t.stringify=q})),O=function(e,t){return G(e,!1,!0).resolve(t)};function j(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var D=/^([a-z0-9.+-]+:)/i,A=/:[0-9]*$/,z=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),T=["'"].concat(z),$=["%","/","?",";","#"].concat(T),_=["/","?","#"],C=/^[a-z0-9A-Z_-]{0,63}$/,U=/^([a-z0-9A-Z_-]{0,63})(.*)$/,N={javascript:!0,"javascript:":!0},P={javascript:!0,"javascript:":!0},L={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function G(e,t,r){if(e&&H(e)&&e instanceof j)return e;var o=new j;return o.parse(e,t,r),o}function J(e){return"string"===typeof e}function H(e){return"object"===typeof e&&null!==e}function V(e){return null===e}j.prototype.parse=function(e,t,r){if(!J(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e;o=o.trim();var n=D.exec(o);if(n){var s=(n=n[0]).toLowerCase();this.protocol=s,o=o.substr(n.length)}if(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var i="//"===o.substr(0,2);!i||n&&P[n]||(o=o.substr(2),this.slashes=!0)}if(!P[n]&&(i||n&&!L[n])){for(var a,p,l=-1,u=0;u<_.length;u++){-1!==(c=o.indexOf(_[u]))&&(-1===l||c<l)&&(l=c)}-1!==(p=-1===l?o.lastIndexOf("@"):o.lastIndexOf("@",l))&&(a=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(a)),l=-1;for(u=0;u<$.length;u++){var c;-1!==(c=o.indexOf($[u]))&&(-1===l||c<l)&&(l=c)}-1===l&&(l=o.length),this.host=o.slice(0,l),o=o.slice(l),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var f=this.hostname.split(/\./),d=(u=0,f.length);u<d;u++){var h=f[u];if(h&&!h.match(C)){for(var w="",g=0,y=h.length;g<y;g++)h.charCodeAt(g)>127?w+="x":w+=h[g];if(!w.match(C)){var R=f.slice(0,u),k=f.slice(u+1),S=h.match(U);S&&(R.push(S[1]),k.unshift(S[2])),k.length&&(o="/"+k.join(".")+o),this.hostname=R.join(".");break}}}if(this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),!m){var I=this.hostname.split("."),b=[];for(u=0;u<I.length;++u){var M=I[u];b.push(M.match(/[^A-Za-z0-9_-]/)?"xn--"+v.encode(M):M)}this.hostname=b.join(".")}var E=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+E,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!N[s])for(u=0,d=T.length;u<d;u++){var x=T[u],F=encodeURIComponent(x);F===x&&(F=escape(x)),o=o.split(x).join(F)}var q=o.indexOf("#");-1!==q&&(this.hash=o.substr(q),o=o.slice(0,q));var O=o.indexOf("?");if(-1!==O?(this.search=o.substr(O),this.query=o.substr(O+1),t&&(this.query=W.parse(this.query)),o=o.slice(0,O)):t&&(this.search="",this.query={}),o&&(this.pathname=o),L[s]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){E=this.pathname||"",M=this.search||"";this.path=E+M}return this.href=this.format(),this},j.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",o=this.hash||"",n=!1,s="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&H(this.query)&&Object.keys(this.query).length&&(s=W.stringify(this.query));var i=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||L[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),o&&"#"!==o.charAt(0)&&(o="#"+o),i&&"?"!==i.charAt(0)&&(i="?"+i),t+n+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(i=i.replace("#","%23"))+o},j.prototype.resolve=function(e){return this.resolveObject(G(e,!1,!0)).format()},j.prototype.resolveObject=function(e){if(J(e)){var t=new j;t.parse(e,!1,!0),e=t}var r=new j;if(Object.keys(this).forEach((function(e){r[e]=this[e]}),this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach((function(t){"protocol"!==t&&(r[t]=e[t])})),L[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!L[e.protocol])return Object.keys(e).forEach((function(t){r[t]=e[t]})),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||P[e.protocol])r.pathname=e.pathname;else{for(var o=(e.pathname||"").split("/");o.length&&!(e.host=o.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),r.pathname=o.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var n=r.pathname||"",s=r.search||"";r.path=n+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var i=r.pathname&&"/"===r.pathname.charAt(0),a=e.host||e.pathname&&"/"===e.pathname.charAt(0),p=a||i||r.host&&e.pathname,l=p,u=r.pathname&&r.pathname.split("/")||[],c=(o=e.pathname&&e.pathname.split("/")||[],r.protocol&&!L[r.protocol]);if(c&&(r.hostname="",r.port=null,r.host&&(""===u[0]?u[0]=r.host:u.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===o[0]?o[0]=e.host:o.unshift(e.host)),e.host=null),p=p&&(""===o[0]||""===u[0])),a)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,u=o;else if(o.length)u||(u=[]),u.pop(),u=u.concat(o),r.search=e.search,r.query=e.query;else if(null!=e.search){if(c)r.hostname=r.host=u.shift(),(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift());return r.search=e.search,r.query=e.query,V(r.pathname)&&V(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!u.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var m=u.slice(-1)[0],f=(r.host||e.host)&&("."===m||".."===m)||""===m,d=0,h=u.length;h>=0;h--)"."==(m=u[h])?u.splice(h,1):".."===m?(u.splice(h,1),d++):d&&(u.splice(h,1),d--);if(!p&&!l)for(;d--;d)u.unshift("..");!p||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),f&&"/"!==u.join("/").substr(-1)&&u.push("");var w,g=""===u[0]||u[0]&&"/"===u[0].charAt(0);c&&(r.hostname=r.host=g?"":u.length?u.shift():"",(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift()));return(p=p||r.host&&u.length)&&!g&&u.unshift(""),u.length?r.pathname=u.join("/"):(r.pathname=null,r.path=null),V(r.pathname)&&V(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},j.prototype.parseHost=function(){var e=this.host,t=A.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};function K(e){return null!==e&&"object"===typeof e&&!1===Array.isArray(e)}function X(e){return"string"===typeof e}function Z(e){return null===e||"undefined"===typeof e}function Y(e,t){if(X(e))return e;if(Z(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to String`)}function Q(e,t){if(function(e){return"number"===typeof e}(e))return e;if(Z(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Number`)}function ee(e,t){if(function(e){return"boolean"===typeof e}(e))return e;if(Z(e)&&"undefined"!==typeof t)return t;throw new Error(`Unable to cast ${typeof e} to Boolean`)}let te=i;async function re(e,t=!1){const r=await(t?async function(e){try{return await e.json()}catch(t){return null}}(e):e.json());if(K(r)&&X(r.error))throw new Error(r.error);return r}function oe(e={}){var t,r;const o=new a;if(o.set("Accept","application/json"),o.set("Content-Type","application/json"),o.set("X-EPI2ME-Client",null!==(t=e.user_agent)&&void 0!==t?t:"api"),o.set("X-EPI2ME-Version",null!==(r=e.agent_version)&&void 0!==r?r:"3.0.1238"),e.headers)for(const[n,s]of Object.entries(e.headers))o.set(n,s);return o}async function ne(e,t){var r;const o=oe(t),n=new URL(e,t.base_url),s={headers:o,method:null!==(r=t.method)&&void 0!==r?r:"get",agent:t.agent,body:t.body};let i=new p(n.toString(),s);t.mutate_request&&(i=await t.mutate_request(i)),t.log&&t.log(i);let a=await te(i);return await async function(e){if(!e.ok){if(504===e.status)throw new Error("Please check your network connection and try again");throw await re(e,!0),new Error("Network error: "+e.statusText)}}(a),t.mutate_response&&(a=await t.mutate_response(a)),a}function se(e,t){if(K(e)){if("json"===t)return JSON.stringify(e);if("url"===t){const t=new URLSearchParams;for(const r of Object.keys(e))t.set(r,String(e[r]));return t.set("json",JSON.stringify(e)),t.sort(),t}throw new Error("Invalid body encoding method "+t)}return e}const ie={head:(e,t={})=>ne(e,Object.assign(Object.assign({},t),{method:"head"})),get:async(e,t={})=>re(await ne(e,Object.assign(Object.assign({},t),{method:"get"}))),async post(e,t,r={}){var o;const n=se(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return re(await ne(e,Object.assign(Object.assign({},r),{body:n,method:"post"})))},async put(e,t,r={}){var o;const n=se(t,null!==(o=r.encode_method)&&void 0!==o?o:"json");return re(await ne(e,Object.assign(Object.assign({},r),{body:n,method:"put"})))}},ae=(...e)=>{};class pe{constructor(p){this.initClient=()=>function(e){const i=new r(t=>{const r=e(),{url:s}=t.getContext(),i=o({uri:O(s,"/graphql"),fetch:r});return n(i,t)}),a=new s;return new t({link:i,cache:a})}(()=>(e,t={})=>{const r=oe({headers:new a(t.headers)});return r.set("Authorization","Bearer "+this.options.jwt),t.headers=r,i(e,t)}),this.createContext=e=>{const{url:t,apikey:r,apisecret:o}=this.options;return Object.assign({apikey:r,apisecret:o,url:t},e)},this.resetCache=()=>{this.client.resetStore()},this.workflows=this.query(e`
    query allWorkflows($page: Int, $pageSize: Int, $isActive: Int, $orderBy: String, $region: String) {
      allWorkflows(page: $page, pageSize: $pageSize, isActive: $isActive, orderBy: $orderBy, region: $region) {
        ${I}
        results {
          ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
        }
      }
    }
  `),this.workflowPages=async e=>{let t=e,r=await this.workflows({variables:{page:t}});const o=async e=>(t=e,r=await this.workflows({variables:{page:t}}),r);return{data:r,next:()=>o(t+1),previous:()=>o(t-1),first:()=>o(1),last:()=>o(0)}},this.workflow=this.query(e`
    query workflow($idWorkflow: ID!) {
      workflow(idWorkflow: $idWorkflow) {
        ${"\nidWorkflow\nname\ndescription\nsummary\nrev\n"}
      }
    }
   `),this.workflowInstances=this.query(e`
  query allWorkflowInstances($page: Int, $pageSize: Int, $shared: Boolean, $idUser: ID, $orderBy: String) {
    allWorkflowInstances(page: $page, pageSize: $pageSize, shared: $shared, idUser: $idUser, orderBy: $orderBy) {
      ${I}
      results {
        ${b}
      }
    }
  }
   `),this.workflowInstance=this.query(e`
      query workflowInstance($idWorkflowInstance: ID!) {
        workflowInstance(idWorkflowInstance: $idWorkflowInstance) {
          ${b}
        }
      }
   `),this.startWorkflow=this.mutate(e`
    mutation startWorkflow(
      $idWorkflow: ID!
      $computeAccountId: ID!
      $storageAccountId: ID
      $isConsentedHuman: Boolean = false
      $idDataset: ID
      $storeResults: Boolean = false
      $userDefined: GenericScalar
      $instanceAttributes: [GenericScalar]
      $region: String
    ) {
      startData: startWorkflowInstance(
        idWorkflow: $idWorkflow
        computeAccountId: $computeAccountId
        storageAccountId: $storageAccountId
        isConsentedHuman: $isConsentedHuman
        idDataset: $idDataset
        storeResults: $storeResults
        userDefined: $userDefined
        instanceAttributes: $instanceAttributes
        region: $region
      ) {
        bucket
        idUser
        remoteAddr
        instance {
          idWorkflowInstance
          chain
          keyId
          outputqueue
          mappedTelemetry
          workflowImage {
            inputqueue
            workflow {
              idWorkflow
            }
            region {
              name
            }
          }
        }
      }
    }
  `),this.stopWorkflow=this.mutate(e`
    mutation stopWorkflowInstance($idWorkflowInstance: ID!) {
      stopData: stopWorkflowInstance(idWorkflowInstance: $idWorkflowInstance) {
        success
        message
      }
    }
  `),this.instanceToken=this.mutate(e`
    mutation getInstanceToken($idWorkflowInstance: ID!) {
      token: getInstanceToken(idWorkflowInstance: $idWorkflowInstance) {
        id_workflow_instance: idWorkflowInstance
        accessKeyId
        secretAccessKey
        sessionToken
        expiration
        region
      }
    }
  `),this.user=this.query(e`
    query user {
      me {
        username
        realname
        useraccountSet {
          idUserAccount
        }
      }
    }
  `),this.updateUser=this.mutate(e`
    mutation updateUser($idRegionPreferred: ID!) {
      updateUser(idRegionPreferred: $idRegionPreferred) {
        idRegionPreferred
      }
    }
  `),this.register=this.mutate(e`
    mutation registerToken($code: String!, $description: String) {
      registerToken(code: $code, description: $description) {
        apikey
        apisecret
        description
      }
    }
  `),this.status=this.query(e`
    query status {
      status {
        portalVersion
        remoteAddr
        serverTime
        minimumAgent
        dbVersion
      }
    }
  `),this.regions=this.query(e`
    query regions {
      regions {
        idRegion
        description
        name
      }
    }
  `);let l=p.url;l=l.replace(/:\/\//,"://graphql."),l=l.replace(/\/$/,"");const{apikey:u,apisecret:c,jwt:m,log:f,local:d,signing:h}=p;this.options={url:l,base_url:l,agent_version:p.agent_version,local:d,user_agent:p.user_agent,signing:h,apikey:u,apisecret:c,jwt:m},this.log=f,this.client=this.initClient()}query(t){return r=>{var o,n,s;const i=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},p=null!==(s=null===r||void 0===r?void 0:r.options)&&void 0!==s?s:{},l=this.createContext(i);let u;return u="string"===typeof t?e`
          ${t}
        `:"function"===typeof t?e`
          ${t(I)}
        `:t,this.client.query(Object.assign(Object.assign({query:u,variables:a},p),{context:l}))}}mutate(t){return r=>{var o,n,s;const i=null!==(o=null===r||void 0===r?void 0:r.context)&&void 0!==o?o:{},a=null!==(n=null===r||void 0===r?void 0:r.variables)&&void 0!==n?n:{},p=null!==(s=null===r||void 0===r?void 0:r.options)&&void 0!==s?s:{},l=this.createContext(i);let u;return u="string"===typeof t?e`
          ${t}
        `:t,this.client.mutate(Object.assign(Object.assign({mutation:u,variables:a},p),{context:l}))}}async convertONTJWT(e,t={token_type:"jwt"}){if("jwt"!==t.token_type&&!t.description)throw new Error("Description required for signature requests");return ie.post("convert-ont",t,Object.assign(Object.assign({},this.options),{log:ae,headers:{"X-ONT-JWT":e}}))}async healthCheck(){return{status:ee((await ie.get("/status",Object.assign(Object.assign({},this.options),{log:ae}))).status)}}}pe.NETWORK_ONLY="network-only",pe.CACHE_FIRST="cache-first",pe.CACHE_AND_NETWORK="cache-and-network",pe.CACHE_ONLY="cache-only",pe.NO_CACHE="no-cache";var le=E((function(e,t){var r=l,o=Function("return this")();r.object.extend(proto,u),r.object.extend(proto,c),r.exportSymbol("proto.epi2me.workflow.RunningInstanceStateReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply",null,o),r.exportSymbol("proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails",null,o),r.exportSymbol("proto.epi2me.workflow.StartReply",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest",null,o),r.exportSymbol("proto.epi2me.workflow.StartRequest.InstanceAttribute",null,o),r.exportSymbol("proto.epi2me.workflow.StopReply",null,o),r.exportSymbol("proto.epi2me.workflow.WorkflowInstanceByIdRequest",null,o),proto.epi2me.workflow.StartRequest=function(e){l.Message.initialize(this,e,0,-1,proto.epi2me.workflow.StartRequest.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.StartRequest,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.displayName="proto.epi2me.workflow.StartRequest"),proto.epi2me.workflow.StartRequest.InstanceAttribute=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartRequest.InstanceAttribute,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.displayName="proto.epi2me.workflow.StartRequest.InstanceAttribute"),proto.epi2me.workflow.StartReply=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StartReply,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StartReply.displayName="proto.epi2me.workflow.StartReply"),proto.epi2me.workflow.RunningInstancesReply=function(e){l.Message.initialize(this,e,0,-1,proto.epi2me.workflow.RunningInstancesReply.repeatedFields_,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.displayName="proto.epi2me.workflow.RunningInstancesReply"),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.displayName="proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails"),proto.epi2me.workflow.WorkflowInstanceByIdRequest=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.WorkflowInstanceByIdRequest,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.displayName="proto.epi2me.workflow.WorkflowInstanceByIdRequest"),proto.epi2me.workflow.RunningInstanceStateReply=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.RunningInstanceStateReply,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.RunningInstanceStateReply.displayName="proto.epi2me.workflow.RunningInstanceStateReply"),proto.epi2me.workflow.StopReply=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.workflow.StopReply,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.workflow.StopReply.displayName="proto.epi2me.workflow.StopReply"),proto.epi2me.workflow.StartRequest.repeatedFields_=[5,25],l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.toObject(e,this)},proto.epi2me.workflow.StartRequest.toObject=function(e,t){var r,o={apikey:l.Message.getFieldWithDefault(t,1,""),apisecret:l.Message.getFieldWithDefault(t,2,""),url:l.Message.getFieldWithDefault(t,3,""),inputfoldersList:null==(r=l.Message.getRepeatedField(t,5))?void 0:r,outputfolder:l.Message.getFieldWithDefault(t,6,""),idworkflow:l.Message.getFieldWithDefault(t,10,""),computeaccountid:l.Message.getFieldWithDefault(t,11,""),storageaccountid:l.Message.getFieldWithDefault(t,20,""),isconsentedhuman:l.Message.getBooleanFieldWithDefault(t,21,!1),iddataset:l.Message.getFieldWithDefault(t,22,""),storeresults:l.Message.getBooleanFieldWithDefault(t,23,!1),userdefined:(r=t.getUserdefined())&&c.Struct.toObject(e,r),instanceattributesList:l.Message.toObjectList(t.getInstanceattributesList(),proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject,e),region:l.Message.getFieldWithDefault(t,26,"")};return e&&(o.$jspbMessageInstance=t),o}),proto.epi2me.workflow.StartRequest.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest;return proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setApikey(r);break;case 2:r=t.readString();e.setApisecret(r);break;case 3:r=t.readString();e.setUrl(r);break;case 5:r=t.readString();e.addInputfolders(r);break;case 6:r=t.readString();e.setOutputfolder(r);break;case 10:r=t.readString();e.setIdworkflow(r);break;case 11:r=t.readString();e.setComputeaccountid(r);break;case 20:r=t.readString();e.setStorageaccountid(r);break;case 21:r=t.readBool();e.setIsconsentedhuman(r);break;case 22:r=t.readString();e.setIddataset(r);break;case 23:r=t.readBool();e.setStoreresults(r);break;case 24:r=new c.Struct;t.readMessage(r,c.Struct.deserializeBinaryFromReader),e.setUserdefined(r);break;case 25:r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;t.readMessage(r,proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader),e.addInstanceattributes(r);break;case 26:r=t.readString();e.setRegion(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.StartRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getApikey()).length>0&&t.writeString(1,r),(r=e.getApisecret()).length>0&&t.writeString(2,r),(r=e.getUrl()).length>0&&t.writeString(3,r),(r=e.getInputfoldersList()).length>0&&t.writeRepeatedString(5,r),(r=e.getOutputfolder()).length>0&&t.writeString(6,r),(r=e.getIdworkflow()).length>0&&t.writeString(10,r),(r=e.getComputeaccountid()).length>0&&t.writeString(11,r),(r=e.getStorageaccountid()).length>0&&t.writeString(20,r),(r=e.getIsconsentedhuman())&&t.writeBool(21,r),(r=e.getIddataset()).length>0&&t.writeString(22,r),(r=e.getStoreresults())&&t.writeBool(23,r),null!=(r=e.getUserdefined())&&t.writeMessage(24,r,c.Struct.serializeBinaryToWriter),(r=e.getInstanceattributesList()).length>0&&t.writeRepeatedMessage(25,r,proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter),(r=e.getRegion()).length>0&&t.writeString(26,r)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.toObject=function(e){return proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject(e,this)},proto.epi2me.workflow.StartRequest.InstanceAttribute.toObject=function(e,t){var r={idAttribute:l.Message.getFieldWithDefault(t,1,0),value:l.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.StartRequest.InstanceAttribute;return proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartRequest.InstanceAttribute.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readUint32();e.setIdAttribute(r);break;case 2:r=t.readString();e.setValue(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartRequest.InstanceAttribute.serializeBinaryToWriter=function(e,t){var r=void 0;0!==(r=e.getIdAttribute())&&t.writeUint32(1,r),(r=e.getValue()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getIdAttribute=function(){return l.Message.getFieldWithDefault(this,1,0)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setIdAttribute=function(e){return l.Message.setProto3IntField(this,1,e)},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.getValue=function(){return l.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.InstanceAttribute.prototype.setValue=function(e){return l.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getApikey=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.StartRequest.prototype.setApikey=function(e){return l.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.StartRequest.prototype.getApisecret=function(){return l.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartRequest.prototype.setApisecret=function(e){return l.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.StartRequest.prototype.getUrl=function(){return l.Message.getFieldWithDefault(this,3,"")},proto.epi2me.workflow.StartRequest.prototype.setUrl=function(e){return l.Message.setProto3StringField(this,3,e)},proto.epi2me.workflow.StartRequest.prototype.getInputfoldersList=function(){return l.Message.getRepeatedField(this,5)},proto.epi2me.workflow.StartRequest.prototype.setInputfoldersList=function(e){return l.Message.setField(this,5,e||[])},proto.epi2me.workflow.StartRequest.prototype.addInputfolders=function(e,t){return l.Message.addToRepeatedField(this,5,e,t)},proto.epi2me.workflow.StartRequest.prototype.clearInputfoldersList=function(){return this.setInputfoldersList([])},proto.epi2me.workflow.StartRequest.prototype.getOutputfolder=function(){return l.Message.getFieldWithDefault(this,6,"")},proto.epi2me.workflow.StartRequest.prototype.setOutputfolder=function(e){return l.Message.setProto3StringField(this,6,e)},proto.epi2me.workflow.StartRequest.prototype.getIdworkflow=function(){return l.Message.getFieldWithDefault(this,10,"")},proto.epi2me.workflow.StartRequest.prototype.setIdworkflow=function(e){return l.Message.setProto3StringField(this,10,e)},proto.epi2me.workflow.StartRequest.prototype.getComputeaccountid=function(){return l.Message.getFieldWithDefault(this,11,"")},proto.epi2me.workflow.StartRequest.prototype.setComputeaccountid=function(e){return l.Message.setProto3StringField(this,11,e)},proto.epi2me.workflow.StartRequest.prototype.getStorageaccountid=function(){return l.Message.getFieldWithDefault(this,20,"")},proto.epi2me.workflow.StartRequest.prototype.setStorageaccountid=function(e){return l.Message.setProto3StringField(this,20,e)},proto.epi2me.workflow.StartRequest.prototype.getIsconsentedhuman=function(){return l.Message.getBooleanFieldWithDefault(this,21,!1)},proto.epi2me.workflow.StartRequest.prototype.setIsconsentedhuman=function(e){return l.Message.setProto3BooleanField(this,21,e)},proto.epi2me.workflow.StartRequest.prototype.getIddataset=function(){return l.Message.getFieldWithDefault(this,22,"")},proto.epi2me.workflow.StartRequest.prototype.setIddataset=function(e){return l.Message.setProto3StringField(this,22,e)},proto.epi2me.workflow.StartRequest.prototype.getStoreresults=function(){return l.Message.getBooleanFieldWithDefault(this,23,!1)},proto.epi2me.workflow.StartRequest.prototype.setStoreresults=function(e){return l.Message.setProto3BooleanField(this,23,e)},proto.epi2me.workflow.StartRequest.prototype.getUserdefined=function(){return l.Message.getWrapperField(this,c.Struct,24)},proto.epi2me.workflow.StartRequest.prototype.setUserdefined=function(e){return l.Message.setWrapperField(this,24,e)},proto.epi2me.workflow.StartRequest.prototype.clearUserdefined=function(){return this.setUserdefined(void 0)},proto.epi2me.workflow.StartRequest.prototype.hasUserdefined=function(){return null!=l.Message.getField(this,24)},proto.epi2me.workflow.StartRequest.prototype.getInstanceattributesList=function(){return l.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.StartRequest.InstanceAttribute,25)},proto.epi2me.workflow.StartRequest.prototype.setInstanceattributesList=function(e){return l.Message.setRepeatedWrapperField(this,25,e)},proto.epi2me.workflow.StartRequest.prototype.addInstanceattributes=function(e,t){return l.Message.addToRepeatedWrapperField(this,25,e,proto.epi2me.workflow.StartRequest.InstanceAttribute,t)},proto.epi2me.workflow.StartRequest.prototype.clearInstanceattributesList=function(){return this.setInstanceattributesList([])},proto.epi2me.workflow.StartRequest.prototype.getRegion=function(){return l.Message.getFieldWithDefault(this,26,"")},proto.epi2me.workflow.StartRequest.prototype.setRegion=function(e){return l.Message.setProto3StringField(this,26,e)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StartReply.prototype.toObject=function(e){return proto.epi2me.workflow.StartReply.toObject(e,this)},proto.epi2me.workflow.StartReply.toObject=function(e,t){var r={started:l.Message.getBooleanFieldWithDefault(t,1,!1),idworkflowinstance:l.Message.getFieldWithDefault(t,2,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StartReply.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.StartReply;return proto.epi2me.workflow.StartReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StartReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setStarted(r);break;case 2:r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StartReply.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.StartReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StartReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getStarted())&&t.writeBool(1,r),(r=e.getIdworkflowinstance()).length>0&&t.writeString(2,r)},proto.epi2me.workflow.StartReply.prototype.getStarted=function(){return l.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StartReply.prototype.setStarted=function(e){return l.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.StartReply.prototype.getIdworkflowinstance=function(){return l.Message.getFieldWithDefault(this,2,"")},proto.epi2me.workflow.StartReply.prototype.setIdworkflowinstance=function(e){return l.Message.setProto3StringField(this,2,e)},proto.epi2me.workflow.RunningInstancesReply.repeatedFields_=[1],l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.toObject=function(e,t){var r={workflowinstanceList:l.Message.toObjectList(t.getWorkflowinstanceList(),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject,e)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply;return proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;t.readMessage(r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader),e.addWorkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getWorkflowinstanceList()).length>0&&t.writeRepeatedMessage(1,r,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject(e,this)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.toObject=function(e,t){var r={idworkflowinstance:l.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.getIdworkflowinstance=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails.prototype.setIdworkflowinstance=function(e){return l.Message.setProto3StringField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.getWorkflowinstanceList=function(){return l.Message.getRepeatedWrapperField(this,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,1)},proto.epi2me.workflow.RunningInstancesReply.prototype.setWorkflowinstanceList=function(e){return l.Message.setRepeatedWrapperField(this,1,e)},proto.epi2me.workflow.RunningInstancesReply.prototype.addWorkflowinstance=function(e,t){return l.Message.addToRepeatedWrapperField(this,1,e,proto.epi2me.workflow.RunningInstancesReply.RunningInstanceDetails,t)},proto.epi2me.workflow.RunningInstancesReply.prototype.clearWorkflowinstanceList=function(){return this.setWorkflowinstanceList([])},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.toObject=function(e){return proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject(e,this)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.toObject=function(e,t){var r={idworkflowinstance:l.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.WorkflowInstanceByIdRequest;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setIdworkflowinstance(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.WorkflowInstanceByIdRequest.serializeBinaryToWriter=function(e,t){var r;(r=e.getIdworkflowinstance()).length>0&&t.writeString(1,r)},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.getIdworkflowinstance=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.workflow.WorkflowInstanceByIdRequest.prototype.setIdworkflowinstance=function(e){return l.Message.setProto3StringField(this,1,e)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.RunningInstanceStateReply.prototype.toObject=function(e){return proto.epi2me.workflow.RunningInstanceStateReply.toObject(e,this)},proto.epi2me.workflow.RunningInstanceStateReply.toObject=function(e,t){var r={upload:l.Message.getBooleanFieldWithDefault(t,1,!1),analyse:l.Message.getBooleanFieldWithDefault(t,2,!1),report:l.Message.getBooleanFieldWithDefault(t,3,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.RunningInstanceStateReply;return proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.RunningInstanceStateReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setUpload(r);break;case 2:r=t.readBool();e.setAnalyse(r);break;case 3:r=t.readBool();e.setReport(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.RunningInstanceStateReply.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.RunningInstanceStateReply.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getUpload())&&t.writeBool(1,r),(r=e.getAnalyse())&&t.writeBool(2,r),(r=e.getReport())&&t.writeBool(3,r)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getUpload=function(){return l.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setUpload=function(e){return l.Message.setProto3BooleanField(this,1,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getAnalyse=function(){return l.Message.getBooleanFieldWithDefault(this,2,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setAnalyse=function(e){return l.Message.setProto3BooleanField(this,2,e)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.getReport=function(){return l.Message.getBooleanFieldWithDefault(this,3,!1)},proto.epi2me.workflow.RunningInstanceStateReply.prototype.setReport=function(e){return l.Message.setProto3BooleanField(this,3,e)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.workflow.StopReply.prototype.toObject=function(e){return proto.epi2me.workflow.StopReply.toObject(e,this)},proto.epi2me.workflow.StopReply.toObject=function(e,t){var r={success:l.Message.getBooleanFieldWithDefault(t,1,!1)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.workflow.StopReply.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.workflow.StopReply;return proto.epi2me.workflow.StopReply.deserializeBinaryFromReader(r,t)},proto.epi2me.workflow.StopReply.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readBool();e.setSuccess(r);break;default:t.skipField()}}return e},proto.epi2me.workflow.StopReply.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.workflow.StopReply.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.workflow.StopReply.serializeBinaryToWriter=function(e,t){var r;(r=e.getSuccess())&&t.writeBool(1,r)},proto.epi2me.workflow.StopReply.prototype.getSuccess=function(){return l.Message.getBooleanFieldWithDefault(this,1,!1)},proto.epi2me.workflow.StopReply.prototype.setSuccess=function(e){return l.Message.setProto3BooleanField(this,1,e)},r.object.extend(t,proto.epi2me.workflow)})),ue=(d.grpc,function(){function e(){}return e.serviceName="epi2me.workflow.Workflow",e}());ue.start={methodName:"start",service:ue,requestStream:!1,responseStream:!1,requestType:le.StartRequest,responseType:le.StartReply},ue.stopUpload={methodName:"stopUpload",service:ue,requestStream:!1,responseStream:!1,requestType:le.WorkflowInstanceByIdRequest,responseType:le.StopReply},ue.stopAnalysis={methodName:"stopAnalysis",service:ue,requestStream:!1,responseStream:!1,requestType:le.WorkflowInstanceByIdRequest,responseType:le.StopReply},ue.running={methodName:"running",service:ue,requestStream:!1,responseStream:!0,requestType:m.Empty,responseType:le.RunningInstancesReply},ue.instanceRunningState={methodName:"instanceRunningState",service:ue,requestStream:!1,responseStream:!0,requestType:le.WorkflowInstanceByIdRequest,responseType:le.RunningInstanceStateReply};var ce=ue;const me=h.Code;function fe(e,t,r,o){const{grpcUrl:n,request:s,service:i}=o;t!==me.OK&&t!==me.Aborted&&e.error({code:t,code_text:me[t],host:n,message:r,request:s,service:i.service.serviceName,method:i.methodName})}function de({tokens:e}){const t=new h.Metadata;return t.set("jwt",e.jwt),t}function he(e,t,r,o,n=!1,s){const i={grpcUrl:e,tokens:t,service:r,request:o,transport:s};return g.create(t=>{if(!e)return t.error({message:"No grpc URL provided"}),y(null);const r=n?function(e,t){const{grpcUrl:r,request:o,service:n,tokens:s,transport:i}=t;return h.invoke(n,{transport:i,host:r,metadata:de({tokens:s}),onEnd:(r,o)=>{fe(e,r,o,t),e.complete()},onMessage:t=>{t&&e.next(t)},request:o})}(t,i):function(e,t){const{grpcUrl:r,request:o,service:n,tokens:s,transport:i}=t;return h.unary(n,{transport:i,host:r,metadata:de({tokens:s}),onEnd:({status:r,message:o})=>{o&&e.next(o),fe(e,r,o,t),e.complete()},request:o})}(t,i);return()=>{r.close(),t.complete()}})}h.setDefaultTransport(h.FetchReadableStreamTransport({credentials:"omit"}));class we{constructor(e,t,r){this._url=e,this._jwt=t,this._transport=r,this._destroySubs$=new R}close(){this._destroySubs$.next()}getRunning$(){const e=new f;return he(this._url,{jwt:this._jwt},ce.running,e,!0,this._transport).pipe(k(e=>e.toObject()),S(this._destroySubs$))}start$(e,t){var r;const o=new le.StartRequest;e.apikey&&o.setApikey(e.apikey),e.apisecret&&o.setApisecret(e.apisecret),e.url&&o.setUrl(e.url),e.inputFolders&&o.setInputfoldersList(e.inputFolders),e.outputFolder&&o.setOutputfolder(e.outputFolder),o.setIdworkflow(Y(t.idWorkflow)),t.computeAccountId&&o.setComputeaccountid(Y(t.computeAccountId)),t.storageAccountId&&o.setStorageaccountid(Y(t.storageAccountId)),t.isConsentedHuman&&o.setIsconsentedhuman(t.isConsentedHuman),t.idDataset&&o.setIddataset(Y(t.idDataset)),t.storeResults&&o.setStoreresults(t.storeResults),t.region&&o.setRegion(t.region),o.setUserdefined(w.fromJavaScript(t.userDefined));for(const n of null!==(r=t.instanceAttributes)&&void 0!==r?r:[]){const e=new le.StartRequest.InstanceAttribute;e.setIdAttribute(Q(n.id_attribute)),e.setValue(n.value),o.addInstanceattributes(e)}return he(this._url,{jwt:this._jwt},ce.running,o,!0,this._transport).pipe(k(e=>e.toObject()),S(this._destroySubs$))}}var ge=E((function(e,t){var r=l,o=Function("return this")();r.exportSymbol("proto.epi2me.samples.ExperimentMap",null,o),r.exportSymbol("proto.epi2me.samples.ExperimentMap.Experiment",null,o),r.exportSymbol("proto.epi2me.samples.ExperimentMap.Sample",null,o),r.exportSymbol("proto.epi2me.samples.SamplesRequest",null,o),proto.epi2me.samples.SamplesRequest=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.SamplesRequest,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.SamplesRequest.displayName="proto.epi2me.samples.SamplesRequest"),proto.epi2me.samples.ExperimentMap=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.ExperimentMap,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.displayName="proto.epi2me.samples.ExperimentMap"),proto.epi2me.samples.ExperimentMap.Experiment=function(e){l.Message.initialize(this,e,0,-1,proto.epi2me.samples.ExperimentMap.Experiment.repeatedFields_,null)},r.inherits(proto.epi2me.samples.ExperimentMap.Experiment,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.Experiment.displayName="proto.epi2me.samples.ExperimentMap.Experiment"),proto.epi2me.samples.ExperimentMap.Sample=function(e){l.Message.initialize(this,e,0,-1,null,null)},r.inherits(proto.epi2me.samples.ExperimentMap.Sample,l.Message),r.DEBUG&&!COMPILED&&(proto.epi2me.samples.ExperimentMap.Sample.displayName="proto.epi2me.samples.ExperimentMap.Sample"),l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.SamplesRequest.prototype.toObject=function(e){return proto.epi2me.samples.SamplesRequest.toObject(e,this)},proto.epi2me.samples.SamplesRequest.toObject=function(e,t){var r={path:l.Message.getFieldWithDefault(t,1,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.SamplesRequest.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.samples.SamplesRequest;return proto.epi2me.samples.SamplesRequest.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.SamplesRequest.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setPath(r);break;default:t.skipField()}}return e},proto.epi2me.samples.SamplesRequest.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.samples.SamplesRequest.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.SamplesRequest.serializeBinaryToWriter=function(e,t){var r;(r=e.getPath()).length>0&&t.writeString(1,r)},proto.epi2me.samples.SamplesRequest.prototype.getPath=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.SamplesRequest.prototype.setPath=function(e){return l.Message.setProto3StringField(this,1,e)},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.toObject(e,this)},proto.epi2me.samples.ExperimentMap.toObject=function(e,t){var r,o={experimentsMap:(r=t.getExperimentsMap())?r.toObject(e,proto.epi2me.samples.ExperimentMap.Experiment.toObject):[]};return e&&(o.$jspbMessageInstance=t),o}),proto.epi2me.samples.ExperimentMap.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap;return proto.epi2me.samples.ExperimentMap.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=e.getExperimentsMap();t.readMessage(r,(function(e,t){l.Map.deserializeBinary(e,t,l.BinaryReader.prototype.readString,l.BinaryReader.prototype.readMessage,proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader,"",new proto.epi2me.samples.ExperimentMap.Experiment)}));break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.samples.ExperimentMap.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getExperimentsMap(!0))&&r.getLength()>0&&r.serializeBinary(1,t,l.BinaryWriter.prototype.writeString,l.BinaryWriter.prototype.writeMessage,proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter)},proto.epi2me.samples.ExperimentMap.Experiment.repeatedFields_=[2],l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.Experiment.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.Experiment.toObject(e,this)},proto.epi2me.samples.ExperimentMap.Experiment.toObject=function(e,t){var r={startdate:l.Message.getFieldWithDefault(t,1,""),samplesList:l.Message.toObjectList(t.getSamplesList(),proto.epi2me.samples.ExperimentMap.Sample.toObject,e)};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap.Experiment;return proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.Experiment.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setStartdate(r);break;case 2:r=new proto.epi2me.samples.ExperimentMap.Sample;t.readMessage(r,proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader),e.addSamples(r);break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.Experiment.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.Experiment.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getStartdate()).length>0&&t.writeString(1,r),(r=e.getSamplesList()).length>0&&t.writeRepeatedMessage(2,r,proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.getStartdate=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.ExperimentMap.Experiment.prototype.setStartdate=function(e){return l.Message.setProto3StringField(this,1,e)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.getSamplesList=function(){return l.Message.getRepeatedWrapperField(this,proto.epi2me.samples.ExperimentMap.Sample,2)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.setSamplesList=function(e){return l.Message.setRepeatedWrapperField(this,2,e)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.addSamples=function(e,t){return l.Message.addToRepeatedWrapperField(this,2,e,proto.epi2me.samples.ExperimentMap.Sample,t)},proto.epi2me.samples.ExperimentMap.Experiment.prototype.clearSamplesList=function(){return this.setSamplesList([])},l.Message.GENERATE_TO_OBJECT&&(proto.epi2me.samples.ExperimentMap.Sample.prototype.toObject=function(e){return proto.epi2me.samples.ExperimentMap.Sample.toObject(e,this)},proto.epi2me.samples.ExperimentMap.Sample.toObject=function(e,t){var r={flowcell:l.Message.getFieldWithDefault(t,1,""),sample:l.Message.getFieldWithDefault(t,2,""),path:l.Message.getFieldWithDefault(t,3,"")};return e&&(r.$jspbMessageInstance=t),r}),proto.epi2me.samples.ExperimentMap.Sample.deserializeBinary=function(e){var t=new l.BinaryReader(e),r=new proto.epi2me.samples.ExperimentMap.Sample;return proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader(r,t)},proto.epi2me.samples.ExperimentMap.Sample.deserializeBinaryFromReader=function(e,t){for(;t.nextField()&&!t.isEndGroup();){switch(t.getFieldNumber()){case 1:var r=t.readString();e.setFlowcell(r);break;case 2:r=t.readString();e.setSample(r);break;case 3:r=t.readString();e.setPath(r);break;default:t.skipField()}}return e},proto.epi2me.samples.ExperimentMap.Sample.prototype.serializeBinary=function(){var e=new l.BinaryWriter;return proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.epi2me.samples.ExperimentMap.Sample.serializeBinaryToWriter=function(e,t){var r=void 0;(r=e.getFlowcell()).length>0&&t.writeString(1,r),(r=e.getSample()).length>0&&t.writeString(2,r),(r=e.getPath()).length>0&&t.writeString(3,r)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getFlowcell=function(){return l.Message.getFieldWithDefault(this,1,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setFlowcell=function(e){return l.Message.setProto3StringField(this,1,e)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getSample=function(){return l.Message.getFieldWithDefault(this,2,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setSample=function(e){return l.Message.setProto3StringField(this,2,e)},proto.epi2me.samples.ExperimentMap.Sample.prototype.getPath=function(){return l.Message.getFieldWithDefault(this,3,"")},proto.epi2me.samples.ExperimentMap.Sample.prototype.setPath=function(e){return l.Message.setProto3StringField(this,3,e)},proto.epi2me.samples.ExperimentMap.prototype.getExperimentsMap=function(e){return l.Message.getMapField(this,1,e,proto.epi2me.samples.ExperimentMap.Experiment)},proto.epi2me.samples.ExperimentMap.prototype.clearExperimentsMap=function(){return this.getExperimentsMap().clear(),this},r.object.extend(t,proto.epi2me.samples)})),ye=(d.grpc,function(){function e(){}return e.serviceName="epi2me.samples.Samples",e}());ye.Samples={methodName:"Samples",service:ye,requestStream:!1,responseStream:!1,requestType:ge.SamplesRequest,responseType:ge.ExperimentMap};var Re=ye;class ke{constructor(e,t,r){this._url=e,this._jwt=t,this._transport=r,this._destroySubs$=new R}close(){this._destroySubs$.next()}getSamples$(e){const t=new ge.SamplesRequest;return t.setPath(e),he(this._url,{jwt:this._jwt},Re.Samples,t,!0,this._transport).pipe(k(e=>e.toObject()),S(this._destroySubs$))}}class Se{constructor(e,t,r){this.url=e,this.workflowApi=new we(e,t,r),this.samplesApi=new ke(e,t,r)}close(){this.samplesApi.close()}}export{Se as EPI2ME_RPC,pe as GraphQL};
